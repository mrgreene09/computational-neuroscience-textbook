<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Hodgkin and Huxley Model | Computational Neuroscience</title>
  <meta name="description" content="TBD" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Hodgkin and Huxley Model | Computational Neuroscience" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/cover.png" />
  <meta property="og:description" content="TBD" />
  <meta name="github-repo" content="mrgreene09/compNeuroTextbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Hodgkin and Huxley Model | Computational Neuroscience" />
  
  <meta name="twitter:description" content="TBD" />
  <meta name="twitter:image" content="/images/cover.png" />

<meta name="author" content="Students of NS/PY 357 Bates College" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Ch3.html"/>
<link rel="next" href="Ch5.html"/>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Computational Neuroscience</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#this-book-is-free-as-in-pizza"><i class="fa fa-check"></i><b>1.1</b> This book is free (as in pizza)</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#this-book-is-free-as-in-speech"><i class="fa fa-check"></i><b>1.2</b> This book is free (as in speech)</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#this-book-can-be-revised-and-disseminated-more-rapidly-than-traditional-textbooks"><i class="fa fa-check"></i><b>1.3</b> This book can be revised and disseminated more rapidly than traditional textbooks</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#this-book-creates-a-public-record-of-learning-that-exists-after-the-semester-ends"><i class="fa fa-check"></i><b>1.4</b> This book creates a public record of learning that exists after the semester ends</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#authors-version-0.0"><i class="fa fa-check"></i><b>1.5</b> Authors: Version 0.0</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#authors-version-1.0"><i class="fa fa-check"></i><b>1.6</b> Authors: Version 1.0</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#authors-version-2.0"><i class="fa fa-check"></i><b>1.7</b> Authors: Version 2.0</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Ch1.html"><a href="Ch1.html"><i class="fa fa-check"></i><b>2</b> Introduction to Python</a>
<ul>
<li class="chapter" data-level="2.1" data-path="Ch1.html"><a href="Ch1.html#vocabulary"><i class="fa fa-check"></i><b>2.1</b> Vocabulary</a></li>
<li class="chapter" data-level="2.2" data-path="Ch1.html"><a href="Ch1.html#introduction"><i class="fa fa-check"></i><b>2.2</b> Introduction</a></li>
<li class="chapter" data-level="2.3" data-path="Ch1.html"><a href="Ch1.html#libraries"><i class="fa fa-check"></i><b>2.3</b> Libraries</a></li>
<li class="chapter" data-level="2.4" data-path="Ch1.html"><a href="Ch1.html#data-types"><i class="fa fa-check"></i><b>2.4</b> Data Types</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="Ch1.html"><a href="Ch1.html#string"><i class="fa fa-check"></i><b>2.4.1</b> String</a></li>
<li class="chapter" data-level="2.4.2" data-path="Ch1.html"><a href="Ch1.html#integers"><i class="fa fa-check"></i><b>2.4.2</b> Integers</a></li>
<li class="chapter" data-level="2.4.3" data-path="Ch1.html"><a href="Ch1.html#floats"><i class="fa fa-check"></i><b>2.4.3</b> Floats</a></li>
<li class="chapter" data-level="2.4.4" data-path="Ch1.html"><a href="Ch1.html#lists"><i class="fa fa-check"></i><b>2.4.4</b> Lists</a></li>
<li class="chapter" data-level="2.4.5" data-path="Ch1.html"><a href="Ch1.html#boolean"><i class="fa fa-check"></i><b>2.4.5</b> Boolean</a></li>
<li class="chapter" data-level="2.4.6" data-path="Ch1.html"><a href="Ch1.html#arrays"><i class="fa fa-check"></i><b>2.4.6</b> Arrays</a></li>
<li class="chapter" data-level="2.4.7" data-path="Ch1.html"><a href="Ch1.html#vectors"><i class="fa fa-check"></i><b>2.4.7</b> Vectors</a></li>
<li class="chapter" data-level="2.4.8" data-path="Ch1.html"><a href="Ch1.html#matrices"><i class="fa fa-check"></i><b>2.4.8</b> Matrices</a></li>
<li class="chapter" data-level="2.4.9" data-path="Ch1.html"><a href="Ch1.html#variable-assignment"><i class="fa fa-check"></i><b>2.4.9</b> Variable assignment</a></li>
<li class="chapter" data-level="2.4.10" data-path="Ch1.html"><a href="Ch1.html#f-strings"><i class="fa fa-check"></i><b>2.4.10</b> f-Strings</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="Ch1.html"><a href="Ch1.html#for-loops"><i class="fa fa-check"></i><b>2.5</b> For loops</a></li>
<li class="chapter" data-level="2.6" data-path="Ch1.html"><a href="Ch1.html#if-elif-else-statements"><i class="fa fa-check"></i><b>2.6</b> If-Elif-Else Statements</a></li>
<li class="chapter" data-level="2.7" data-path="Ch1.html"><a href="Ch1.html#conditional-statements"><i class="fa fa-check"></i><b>2.7</b> Conditional statements</a></li>
<li class="chapter" data-level="2.8" data-path="Ch1.html"><a href="Ch1.html#logic-statements"><i class="fa fa-check"></i><b>2.8</b> Logic statements</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="Ch1.html"><a href="Ch1.html#and-or-not"><i class="fa fa-check"></i><b>2.8.1</b> “And”, “Or”, “Not”</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="Ch1.html"><a href="Ch1.html#while-loops"><i class="fa fa-check"></i><b>2.9</b> While loops</a></li>
<li class="chapter" data-level="2.10" data-path="Ch1.html"><a href="Ch1.html#summary"><i class="fa fa-check"></i><b>2.10</b> Summary</a></li>
<li class="chapter" data-level="2.11" data-path="Ch1.html"><a href="Ch1.html#example-python-problems"><i class="fa fa-check"></i><b>2.11</b> Example Python Problems</a></li>
<li class="chapter" data-level="2.12" data-path="Ch1.html"><a href="Ch1.html#conceptual-exercises-for-learning-python"><i class="fa fa-check"></i><b>2.12</b> Conceptual Exercises for Learning Python</a></li>
<li class="chapter" data-level="2.13" data-path="Ch1.html"><a href="Ch1.html#coding-exercises-for-learning-python"><i class="fa fa-check"></i><b>2.13</b> Coding Exercises for Learning Python</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Ch2.html"><a href="Ch2.html"><i class="fa fa-check"></i><b>3</b> What is Computational Neuroscience?</a>
<ul>
<li class="chapter" data-level="3.1" data-path="Ch2.html"><a href="Ch2.html#vocabulary-1"><i class="fa fa-check"></i><b>3.1</b> Vocabulary</a></li>
<li class="chapter" data-level="3.2" data-path="Ch2.html"><a href="Ch2.html#introduction-1"><i class="fa fa-check"></i><b>3.2</b> Introduction</a></li>
<li class="chapter" data-level="3.3" data-path="Ch2.html"><a href="Ch2.html#what-is-computational-neuroscience"><i class="fa fa-check"></i><b>3.3</b> What is computational neuroscience?</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="Ch2.html"><a href="Ch2.html#can-we-make-models-that-understand"><i class="fa fa-check"></i><b>3.3.1</b> Can we make models that understand?</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="Ch2.html"><a href="Ch2.html#levels-of-organization"><i class="fa fa-check"></i><b>3.4</b> Levels of organization</a></li>
<li class="chapter" data-level="3.5" data-path="Ch2.html"><a href="Ch2.html#applications-of-computational-neuroscience"><i class="fa fa-check"></i><b>3.5</b> Applications of computational neuroscience</a></li>
<li class="chapter" data-level="3.6" data-path="Ch2.html"><a href="Ch2.html#the-future-of-computational-neuroscience"><i class="fa fa-check"></i><b>3.6</b> The future of computational neuroscience</a></li>
<li class="chapter" data-level="3.7" data-path="Ch2.html"><a href="Ch2.html#summary-1"><i class="fa fa-check"></i><b>3.7</b> Summary</a></li>
<li class="chapter" data-level="3.8" data-path="Ch2.html"><a href="Ch2.html#exercises"><i class="fa fa-check"></i><b>3.8</b> Exercises:</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Ch3.html"><a href="Ch3.html"><i class="fa fa-check"></i><b>4</b> Passive Membrane Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="Ch3.html"><a href="Ch3.html#vocabulary-2"><i class="fa fa-check"></i><b>4.1</b> Vocabulary</a></li>
<li class="chapter" data-level="4.2" data-path="Ch3.html"><a href="Ch3.html#introduction-2"><i class="fa fa-check"></i><b>4.2</b> Introduction</a></li>
<li class="chapter" data-level="4.3" data-path="Ch3.html"><a href="Ch3.html#membrane-potentials-and-electrochemical-gradients"><i class="fa fa-check"></i><b>4.3</b> Membrane potentials and electrochemical gradients</a></li>
<li class="chapter" data-level="4.4" data-path="Ch3.html"><a href="Ch3.html#phases-of-the-action-potential"><i class="fa fa-check"></i><b>4.4</b> Phases of the action potential</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="Ch3.html"><a href="Ch3.html#positive-feedback-and-depolarization"><i class="fa fa-check"></i><b>4.4.1</b> Positive feedback and depolarization</a></li>
<li class="chapter" data-level="4.4.2" data-path="Ch3.html"><a href="Ch3.html#negative-feedback-and-repolarization"><i class="fa fa-check"></i><b>4.4.2</b> Negative feedback and repolarization</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="Ch3.html"><a href="Ch3.html#nernst-equilibrium-potential"><i class="fa fa-check"></i><b>4.5</b> Nernst equilibrium potential</a></li>
<li class="chapter" data-level="4.6" data-path="Ch3.html"><a href="Ch3.html#leaky-integrate-and-fire-model"><i class="fa fa-check"></i><b>4.6</b> Leaky Integrate and Fire Model</a></li>
<li class="chapter" data-level="4.7" data-path="Ch3.html"><a href="Ch3.html#summary-2"><i class="fa fa-check"></i><b>4.7</b> Summary</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="Ch3.html"><a href="Ch3.html#passive-membrane-model"><i class="fa fa-check"></i><b>4.7.1</b> Passive membrane model:</a></li>
<li class="chapter" data-level="4.7.2" data-path="Ch3.html"><a href="Ch3.html#an-action-potential-has-six-phases"><i class="fa fa-check"></i><b>4.7.2</b> An action potential has six phases:</a></li>
<li class="chapter" data-level="4.7.3" data-path="Ch3.html"><a href="Ch3.html#main-features-of-an-action-potential"><i class="fa fa-check"></i><b>4.7.3</b> Main features of an action potential:</a></li>
<li class="chapter" data-level="4.7.4" data-path="Ch3.html"><a href="Ch3.html#the-flow-of-ions-and-equilibrium-potentials"><i class="fa fa-check"></i><b>4.7.4</b> The flow of ions and equilibrium potentials</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="Ch3.html"><a href="Ch3.html#exercises-1"><i class="fa fa-check"></i><b>4.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="Ch3.html"><a href="Ch3.html#conceptual-exercises"><i class="fa fa-check"></i><b>4.8.1</b> Conceptual Exercises</a></li>
<li class="chapter" data-level="4.8.2" data-path="Ch3.html"><a href="Ch3.html#coding-exercises"><i class="fa fa-check"></i><b>4.8.2</b> Coding Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Ch4.html"><a href="Ch4.html"><i class="fa fa-check"></i><b>5</b> Hodgkin and Huxley Model</a>
<ul>
<li class="chapter" data-level="5.1" data-path="Ch4.html"><a href="Ch4.html#vocabulary-3"><i class="fa fa-check"></i><b>5.1</b> Vocabulary</a></li>
<li class="chapter" data-level="5.2" data-path="Ch4.html"><a href="Ch4.html#introduction-3"><i class="fa fa-check"></i><b>5.2</b> Introduction</a></li>
<li class="chapter" data-level="5.3" data-path="Ch4.html"><a href="Ch4.html#the-hodgkin-and-huxley-model"><i class="fa fa-check"></i><b>5.3</b> The Hodgkin and Huxley model</a></li>
<li class="chapter" data-level="5.4" data-path="Ch4.html"><a href="Ch4.html#summary-3"><i class="fa fa-check"></i><b>5.4</b> Summary</a></li>
<li class="chapter" data-level="5.5" data-path="Ch4.html"><a href="Ch4.html#exercises-2"><i class="fa fa-check"></i><b>5.5</b> Exercises:</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="Ch4.html"><a href="Ch4.html#conceptual-exercises-1"><i class="fa fa-check"></i><b>5.5.1</b> Conceptual Exercises:</a></li>
<li class="chapter" data-level="5.5.2" data-path="Ch4.html"><a href="Ch4.html#coding-exercises-1"><i class="fa fa-check"></i><b>5.5.2</b> Coding Exercises:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Ch5.html"><a href="Ch5.html"><i class="fa fa-check"></i><b>6</b> Firing Rates</a>
<ul>
<li class="chapter" data-level="6.1" data-path="Ch5.html"><a href="Ch5.html#vocabulary-4"><i class="fa fa-check"></i><b>6.1</b> Vocabulary</a></li>
<li class="chapter" data-level="6.2" data-path="Ch5.html"><a href="Ch5.html#introduction-4"><i class="fa fa-check"></i><b>6.2</b> Introduction</a></li>
<li class="chapter" data-level="6.3" data-path="Ch5.html"><a href="Ch5.html#spike-trains"><i class="fa fa-check"></i><b>6.3</b> Spike Trains</a></li>
<li class="chapter" data-level="6.4" data-path="Ch5.html"><a href="Ch5.html#spike-statistics"><i class="fa fa-check"></i><b>6.4</b> Spike Statistics</a></li>
<li class="chapter" data-level="6.5" data-path="Ch5.html"><a href="Ch5.html#poisson-processes"><i class="fa fa-check"></i><b>6.5</b> Poisson Processes</a></li>
<li class="chapter" data-level="6.6" data-path="Ch5.html"><a href="Ch5.html#summary-4"><i class="fa fa-check"></i><b>6.6</b> Summary</a></li>
<li class="chapter" data-level="6.7" data-path="Ch5.html"><a href="Ch5.html#exercises-3"><i class="fa fa-check"></i><b>6.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="Ch5.html"><a href="Ch5.html#conceptual-problems"><i class="fa fa-check"></i><b>6.7.1</b> Conceptual Problems</a></li>
<li class="chapter" data-level="6.7.2" data-path="Ch5.html"><a href="Ch5.html#coding-problems"><i class="fa fa-check"></i><b>6.7.2</b> Coding Problems</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Ch6.html"><a href="Ch6.html"><i class="fa fa-check"></i><b>7</b> Reverse Correlation and Receptive Field Mapping</a>
<ul>
<li class="chapter" data-level="7.1" data-path="Ch6.html"><a href="Ch6.html#vocabulary-5"><i class="fa fa-check"></i><b>7.1</b> Vocabulary</a></li>
<li class="chapter" data-level="7.2" data-path="Ch6.html"><a href="Ch6.html#introduction-5"><i class="fa fa-check"></i><b>7.2</b> Introduction</a></li>
<li class="chapter" data-level="7.3" data-path="Ch6.html"><a href="Ch6.html#spike-triggered-average"><i class="fa fa-check"></i><b>7.3</b> Spike-triggered Average</a></li>
<li class="chapter" data-level="7.4" data-path="Ch6.html"><a href="Ch6.html#reverse-correlation"><i class="fa fa-check"></i><b>7.4</b> Reverse Correlation</a></li>
<li class="chapter" data-level="7.5" data-path="Ch6.html"><a href="Ch6.html#summary-5"><i class="fa fa-check"></i><b>7.5</b> Summary</a></li>
<li class="chapter" data-level="7.6" data-path="Ch6.html"><a href="Ch6.html#exercises-4"><i class="fa fa-check"></i><b>7.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="Ch6.html"><a href="Ch6.html#conceptual-exercises-2"><i class="fa fa-check"></i><b>7.6.1</b> Conceptual Exercises</a></li>
<li class="chapter" data-level="7.6.2" data-path="Ch6.html"><a href="Ch6.html#coding-exercises-2"><i class="fa fa-check"></i><b>7.6.2</b> Coding Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Ch7.html"><a href="Ch7.html"><i class="fa fa-check"></i><b>8</b> Decoding</a>
<ul>
<li class="chapter" data-level="8.1" data-path="Ch7.html"><a href="Ch7.html#vocabulary-6"><i class="fa fa-check"></i><b>8.1</b> Vocabulary</a></li>
<li class="chapter" data-level="8.2" data-path="Ch7.html"><a href="Ch7.html#introduction-6"><i class="fa fa-check"></i><b>8.2</b> Introduction</a></li>
<li class="chapter" data-level="8.3" data-path="Ch7.html"><a href="Ch7.html#imaging-techniques"><i class="fa fa-check"></i><b>8.3</b> Imaging Techniques</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="Ch7.html"><a href="Ch7.html#eeg"><i class="fa fa-check"></i><b>8.3.1</b> EEG</a></li>
<li class="chapter" data-level="8.3.2" data-path="Ch7.html"><a href="Ch7.html#meg"><i class="fa fa-check"></i><b>8.3.2</b> MEG</a></li>
<li class="chapter" data-level="8.3.3" data-path="Ch7.html"><a href="Ch7.html#fmri"><i class="fa fa-check"></i><b>8.3.3</b> fMRI</a></li>
<li class="chapter" data-level="8.3.4" data-path="Ch7.html"><a href="Ch7.html#ecog"><i class="fa fa-check"></i><b>8.3.4</b> ECOG</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="Ch7.html"><a href="Ch7.html#introduction-to-decoding"><i class="fa fa-check"></i><b>8.4</b> Introduction to Decoding</a></li>
<li class="chapter" data-level="8.5" data-path="Ch7.html"><a href="Ch7.html#what-is-a-classifier"><i class="fa fa-check"></i><b>8.5</b> What is a classifier?</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="Ch7.html"><a href="Ch7.html#correlation-classifiers"><i class="fa fa-check"></i><b>8.5.1</b> Correlation classifiers</a></li>
<li class="chapter" data-level="8.5.2" data-path="Ch7.html"><a href="Ch7.html#distance-based-classifiers"><i class="fa fa-check"></i><b>8.5.2</b> Distance-based classifiers</a></li>
<li class="chapter" data-level="8.5.3" data-path="Ch7.html"><a href="Ch7.html#boundary-based-classifiers"><i class="fa fa-check"></i><b>8.5.3</b> Boundary-based classifiers</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="Ch7.html"><a href="Ch7.html#cross-validation"><i class="fa fa-check"></i><b>8.6</b> Cross validation</a></li>
<li class="chapter" data-level="8.7" data-path="Ch7.html"><a href="Ch7.html#conclusion"><i class="fa fa-check"></i><b>8.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Ch8.html"><a href="Ch8.html"><i class="fa fa-check"></i><b>9</b> Neural Networks</a>
<ul>
<li class="chapter" data-level="9.1" data-path="Ch8.html"><a href="Ch8.html#vocabulary-list"><i class="fa fa-check"></i><b>9.1</b> Vocabulary List:</a></li>
<li class="chapter" data-level="9.2" data-path="Ch8.html"><a href="Ch8.html#introductionbackground"><i class="fa fa-check"></i><b>9.2</b> Introduction/Background</a></li>
<li class="chapter" data-level="9.3" data-path="Ch8.html"><a href="Ch8.html#different-types-of-learning"><i class="fa fa-check"></i><b>9.3</b> Different Types of Learning</a></li>
<li class="chapter" data-level="9.4" data-path="Ch8.html"><a href="Ch8.html#mcculloch-pitt-mcp-neurons"><i class="fa fa-check"></i><b>9.4</b> McCulloch-Pitt (MCP) Neurons</a></li>
<li class="chapter" data-level="9.5" data-path="Ch8.html"><a href="Ch8.html#perceptron"><i class="fa fa-check"></i><b>9.5</b> Perceptron</a></li>
<li class="chapter" data-level="9.6" data-path="Ch8.html"><a href="Ch8.html#summary-6"><i class="fa fa-check"></i><b>9.6</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Ch9.html"><a href="Ch9.html"><i class="fa fa-check"></i><b>10</b> Glossary</a></li>
<li class="chapter" data-level="11" data-path="Ch10.html"><a href="Ch10.html"><i class="fa fa-check"></i><b>11</b> References</a>
<ul>
<li class="chapter" data-level="11.1" data-path="Ch10.html"><a href="Ch10.html#chapter-1-preface"><i class="fa fa-check"></i><b>11.1</b> Chapter 1: Preface</a></li>
<li class="chapter" data-level="11.2" data-path="Ch10.html"><a href="Ch10.html#chapter-2-introduction-to-python"><i class="fa fa-check"></i><b>11.2</b> Chapter 2: Introduction to Python</a></li>
<li class="chapter" data-level="11.3" data-path="Ch10.html"><a href="Ch10.html#chapter-3-what-is-computational-neuroscience"><i class="fa fa-check"></i><b>11.3</b> Chapter 3: What is Computational Neuroscience?</a></li>
<li class="chapter" data-level="11.4" data-path="Ch10.html"><a href="Ch10.html#chapter-4-passive-membrane-models"><i class="fa fa-check"></i><b>11.4</b> Chapter 4: Passive Membrane Models</a></li>
<li class="chapter" data-level="11.5" data-path="Ch10.html"><a href="Ch10.html#chapter-5-hodgkin-and-huxley"><i class="fa fa-check"></i><b>11.5</b> Chapter 5: Hodgkin and Huxley</a></li>
<li class="chapter" data-level="11.6" data-path="Ch10.html"><a href="Ch10.html#chapter-6-firing-rates"><i class="fa fa-check"></i><b>11.6</b> Chapter 6: Firing Rates</a></li>
<li class="chapter" data-level="11.7" data-path="Ch10.html"><a href="Ch10.html#chapter-7-reverse-correlation-and-receptive-field-mapping"><i class="fa fa-check"></i><b>11.7</b> Chapter 7: Reverse Correlation and Receptive Field Mapping</a></li>
<li class="chapter" data-level="11.8" data-path="Ch10.html"><a href="Ch10.html#chapter-8-decoding"><i class="fa fa-check"></i><b>11.8</b> Chapter 8: Decoding</a></li>
<li class="chapter" data-level="11.9" data-path="Ch10.html"><a href="Ch10.html#chapter-9-neural-networks"><i class="fa fa-check"></i><b>11.9</b> Chapter 9: Neural Networks</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="Ch11.html"><a href="Ch11.html"><i class="fa fa-check"></i><b>12</b> Answers to Exercises</a>
<ul>
<li class="chapter" data-level="12.1" data-path="Ch11.html"><a href="Ch11.html#chapter-1-introduction-to-python"><i class="fa fa-check"></i><b>12.1</b> Chapter 1: Introduction to Python</a></li>
<li class="chapter" data-level="12.2" data-path="Ch11.html"><a href="Ch11.html#chapter-2-introduction-to-computational-neuroscience"><i class="fa fa-check"></i><b>12.2</b> Chapter 2: Introduction to Computational Neuroscience</a></li>
<li class="chapter" data-level="12.3" data-path="Ch11.html"><a href="Ch11.html#chapter-3-passive-membrane-models"><i class="fa fa-check"></i><b>12.3</b> Chapter 3: Passive Membrane Models</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="Ch11.html"><a href="Ch11.html#conceptual-questions"><i class="fa fa-check"></i><b>12.3.1</b> Conceptual Questions</a></li>
<li class="chapter" data-level="12.3.2" data-path="Ch11.html"><a href="Ch11.html#coding-questions"><i class="fa fa-check"></i><b>12.3.2</b> Coding Questions</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="Ch11.html"><a href="Ch11.html#chapter-4-hodgkin-and-huxley"><i class="fa fa-check"></i><b>12.4</b> Chapter 4: Hodgkin and Huxley</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="Ch11.html"><a href="Ch11.html#conceptual-questions-1"><i class="fa fa-check"></i><b>12.4.1</b> Conceptual Questions:</a></li>
<li class="chapter" data-level="12.4.2" data-path="Ch11.html"><a href="Ch11.html#coding-questions-1"><i class="fa fa-check"></i><b>12.4.2</b> Coding Questions:</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="Ch11.html"><a href="Ch11.html#chapter-5-firing-rates"><i class="fa fa-check"></i><b>12.5</b> Chapter 5: Firing Rates</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="Ch11.html"><a href="Ch11.html#conceptual-questions-2"><i class="fa fa-check"></i><b>12.5.1</b> Conceptual Questions</a></li>
<li class="chapter" data-level="12.5.2" data-path="Ch11.html"><a href="Ch11.html#coding-questions-2"><i class="fa fa-check"></i><b>12.5.2</b> Coding Questions</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="Ch11.html"><a href="Ch11.html#chapter-6-reverse-correlation-and-receptive-field-mapping"><i class="fa fa-check"></i><b>12.6</b> Chapter 6: Reverse Correlation and Receptive Field Mapping</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="Ch11.html"><a href="Ch11.html#conceptual-questions-3"><i class="fa fa-check"></i><b>12.6.1</b> Conceptual Questions</a></li>
<li class="chapter" data-level="12.6.2" data-path="Ch11.html"><a href="Ch11.html#coding-questions-3"><i class="fa fa-check"></i><b>12.6.2</b> Coding Questions</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="Ch11.html"><a href="Ch11.html#chapter-7-decoding"><i class="fa fa-check"></i><b>12.7</b> Chapter 7: Decoding</a></li>
<li class="chapter" data-level="12.8" data-path="Ch11.html"><a href="Ch11.html#chapter-8-neural-networks"><i class="fa fa-check"></i><b>12.8</b> Chapter 8: Neural Networks</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Computational Neuroscience</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Ch4" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Hodgkin and Huxley Model<a href="Ch4.html#Ch4" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="vocabulary-3" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Vocabulary<a href="Ch4.html#vocabulary-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Gating variable</li>
<li>Non-permissive</li>
<li>Permissive</li>
<li>Rate constant</li>
<li>Voltage clamp</li>
</ul>
</div>
<div id="introduction-3" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Introduction<a href="Ch4.html#introduction-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Alan Hodgkin and Andrew Huxley were two of the most influential neuroscientists of the 20th century. The two met in 1938 at Trinity College, Cambridge where Huxley was an undergraduate student, and Hodgkin was a teacher. Huxley was only 21 years old, and Hodgkin was 24. Both of them were interested in understanding the particular dynamics of ion flow in neurons, so they began to conduct their own research as partners at the <a href="https://history.archives.mbl.edu/browse/exhibits/squids-axons-and-action-potentials-stories-neurobiological-discovery/alan-hodgkin">Plymouth Marine Laboratory in 1939</a>.</p>
<div style="float:left;width:564px">
<div class="figure"><span style="display:block;" id="fig:hodgkinHuxley-fig"></span>
<img src="images/HodgkinHuxley.png" alt="Alan Hodgkin (left) and Andrew Huxley (right)." width="273" />
<p class="caption">
Figure 5.1: Alan Hodgkin (left) and Andrew Huxley (right).
</p>
</div>
</div>
<p>Hodgkin and Huxley’s most important research centered around the activity of the giant axon of the longfin inshore squid. Squid are able to jet rapidly by contracting muscles in their mantle cavity, expelling water through a siphon on the underside of their body. This action is initiated by the giant axon. Since squid do not have a skull to constrain the growth of their neurons, this axon can measure up to 1.5 mm in diameter. Its large size means that its signal propagates extremely quickly, allowing the squid to rapidly respond to danger. The giant axon is hundreds of times larger than the largest axons in humans, making it much easier to study; it is visible to the naked eye and it is possible to insert the tip of a microelectrode into the membrane to record its activity. Hodgkin and Huxley took advantage of this fact to interrogate the electrochemical dynamics of neurons.</p>
<p>Hodgkin and Huxley used the <a href="https://www.youtube.com/watch?v=k48jXzFGMc8&amp;feature=youtu.be">voltage clamp technique</a> to take their recordings. In this procedure, the giant axon is submerged in a solution of ions. Two wires are inserted into the membrane, and another is inserted into the solution. The two wires inside and outside the cell record the voltage, and the difference between these values represents the membrane potential. The third electrode is used to stimulate the neuron with varying amounts of current, and record the corresponding changes in voltage. Unfortunately, Hodgkin and Huxley took their first recordings in 1939 just weeks before Hitler invaded Poland, marking the start of World War II. Their research was postponed for seven years, but they were eventually able to continue their work and developed their beautiful set of equations (using only a hand-operated calculator) that attempt to describe the biological mechanisms of neuronal firing. Hodgkin and Huxley’s research greatly advanced our understanding of neuroscience, and they were awarded the Nobel Prize in Physiology of Medicine in 1963 for their work.</p>
</div>
<div id="the-hodgkin-and-huxley-model" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> The Hodgkin and Huxley model<a href="Ch4.html#the-hodgkin-and-huxley-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In simple terms, the Hodgkin-Huxley Model is an elaboration on the previously discussed Integrate and Fire Model. While the Integrate and Fire Model only accounts for a single “leak” current when modeling action potentials, the Hodgkin-Huxley Model acknowledges the role of ionic sodium and potassium currents <em>in addition to</em> leak currents through the use of conductance terms, known as <strong>gating variables</strong>.</p>
<div style="float:center;width:450px">
<div class="figure"><span style="display:block;" id="fig:gatingVariable-fig"></span>
<img src="images/gating_variables.png" alt="Idealized voltage-gated potassium (left) and sodium (right) channels. Each channel has four independent subunits that are comprised of different gating variables (n, m, or h)." width="611" />
<p class="caption">
Figure 5.2: Idealized voltage-gated potassium (left) and sodium (right) channels. Each channel has four independent subunits that are comprised of different gating variables (n, m, or h).
</p>
</div>
</div>
<p>For the purposes of this model, voltage-gated potassium and sodium channels consist of four independent subunits, and each of these subunits are comprised of a gating variable, <em>n</em>, <em>m</em>, or <em>h</em>, as seen in Figure 5.2. The value of these gating variables represents the probability that an ion channel is open at a given voltage.</p>
<p>Voltage-gated potassium channels are modeled by the gating variable for potassium activation, <em>n</em>. Because potassium channels have a single gating variable that makes up each of the four subunits, <em>n</em> is raised to the fourth power. The conductance of voltage-gated potassium channels is modeled below: <span class="math display">\[\bar{g}_{K}n^{4}(V(t)-E_{K}) \]</span><br />
Voltage-gated sodium channel activation is modeled by the gating variables for <a href="https://upload.wikimedia.org/wikipedia/en/thumb/b/bb/Inactivation_diagram.jpg/400px-Inactivation_diagram.jpg">sodium activation and inactivation</a>, which are represented as <em>m</em> and <em>h</em>, respectively. <em>m</em> makes up three of the independent subunits and, as a result, is raised to the third power. On the other hand, <em>h</em>, which occurs when the action potential approaches its peak, makes up a single subunit. The combination of <em>m</em> and <em>h</em> gives rise to the conductance of the voltage-gated sodium channel, modeled below: <span class="math display">\[\bar{g}_{Na}m^{3}h(V(t)-E_{Na}) \]</span></p>
<p>The final conductance taken into account by Hodgkin and Huxley is the leak potential of all the ions when all ion channels are open. This conductance of the leak channels is represented below: <span class="math display">\[\bar{g}_{L}(V(t)-E_{L}) \]</span></p>
<p>These three conductance variables are combined together to form the Hodgkin-Huxley equation which is written as follows: <span class="math display">\[C\frac{dV}{dt}=I_{e}(t)-[(\bar{g}_{Na}m^{3}h(V(t)-E_{Na}))+(\bar{g}_{K}n^{4}(V(t)-E_{K}))+(\bar{g}_{L}(V(t)-E_{L}))] \]</span></p>
<table>
<thead>
<tr class="header">
<th>Expression</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>n</em></td>
<td>Potassium gating variable</td>
</tr>
<tr class="even">
<td><em>m</em></td>
<td>Sodium activation gating variable</td>
</tr>
<tr class="odd">
<td><em>h</em></td>
<td>Sodium inactivation gating variable</td>
</tr>
<tr class="even">
<td><span class="math inline">\(C_m\)</span></td>
<td>Specific membrane capacitance</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(I_e\)</span></td>
<td>Injected current</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\bar{g}_{Na}\)</span></td>
<td>Maximum Na+ conductance</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\bar{g}_{K}\)</span></td>
<td>Maximum K+ conductance</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\bar{g}_{L}\)</span></td>
<td>Maximum leak conductance</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(V_m\)</span></td>
<td>Membrane potential</td>
</tr>
<tr class="even">
<td><span class="math inline">\(E_{Na}\)</span></td>
<td>Sodium Nernst potential</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(E_{K}\)</span></td>
<td>Potassium Nernst potential</td>
</tr>
<tr class="even">
<td><span class="math inline">\(E_{L}\)</span></td>
<td>Leak Nernst potential</td>
</tr>
</tbody>
</table>
<div class="figure"><span style="display:block;" id="fig:rateConstants-fig"></span>
<img src="images/rateConstants.png" alt="Each of an ion channel's subunits can either be in a permissive or non-permissive state. Movement from a permissive state to a non-permissive state is denoted as $\beta$, whereas movement from a non-permissive state to a permissive state is denoted as $\alpha$." width="240" />
<p class="caption">
Figure 5.3: Each of an ion channel’s subunits can either be in a permissive or non-permissive state. Movement from a permissive state to a non-permissive state is denoted as <span class="math inline">\(\beta\)</span>, whereas movement from a non-permissive state to a permissive state is denoted as <span class="math inline">\(\alpha\)</span>.
</p>
</div>
<p>Each of the aforementioned subunits of voltage-gated potassium and sodium channels can be in one of two states: <em>permissive</em> or <em>non-permissive</em>. If a subunit is in a permissive state, the probability that the ion channel is open is increased, with the opposite being true for a subunit in a non-permissive state. The rate of movement from a permissive state to a non-permissive state is expressed as <em>rate constant</em> <span class="math inline">\(\beta\)</span>, and the movement from a non-permissive to permissive state is expressed as <em>rate constant</em> <span class="math inline">\(\alpha\)</span>. Below are the equations for both rate constants for each gating variable:</p>
<p><span class="math display">\[ \alpha_{n}(V_{m}) = \frac{0.01(V_{m}+55)}{1-exp(-0.1(V_{m}+55))} \]</span>
<span class="math display">\[\alpha_{m}(V_{m}) = \frac{0.1(V_{m}+40)}{1-exp(-0.1(V_{m}+40))}\]</span>
<span class="math display">\[\alpha_{h}(V_{m}) = 0.07exp(-0.05(V_{m}+65)) \]</span>
<span class="math display">\[\beta_{n}(V_m) = 0.125exp(-0.0125(V_{m}+65)) \]</span>
<span class="math display">\[\beta_{m}(V_{m}) = 4exp(-0.0556(V_{m}+65)) \]</span>
<span class="math display">\[\beta_{h}(V_{m}) = \frac{1}{1+exp(-0.1(V_{m}+35))} \]</span></p>
<table>
<thead>
<tr class="header">
<th>Expression</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\alpha_n\)</span></td>
<td>Rate constant for K+ channel opening</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\alpha_m\)</span></td>
<td>Rate constant for Na+ activation gate opening</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\alpha_h\)</span></td>
<td>Rate constant for Na+ inactivation gate opening</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta_n\)</span></td>
<td>Rate constant for K+ channel closing</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\beta_m\)</span></td>
<td>Rate constant for Na+ activation gate closing</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta_h\)</span></td>
<td>Rate constant for Na+ inactivation gate closing</td>
</tr>
</tbody>
</table>
<p>Given this information, we can calculate the value of each gating variable over different voltages and times: <span class="math display">\[m\frac{dV}{dt} = \alpha_{m}(V)(1-m)-\beta_{m}(V)m \]</span></p>
<p>Both <em>n</em> and <em>h</em> can be substituted for <em>m</em> in the above equation in order to calculate values for each gating variable.</p>
<p><strong>Worked Example:</strong><br />
Have you ever wondered how anesthesia makes a tooth extraction painless? It’s because anesthesia works by blocking the activation of voltage-dependent Na+ channels. This prevents the propagation of the action potentials that carry that awful pain sensation.</p>
<p>Using the equations below, calculate the maximum conductances of each ion in the resting state.</p>
<p>Useful parameters:</p>
<ul>
<li><span class="math inline">\(V_m\)</span> = -68 mV</li>
<li><span class="math inline">\(C_m\)</span> = -20.1 nF</li>
<li><span class="math inline">\(E_L\)</span> = -54 mV</li>
<li><span class="math inline">\(E_{Na}\)</span> = 50 mV</li>
<li><span class="math inline">\(E_K\)</span> = -77 mV</li>
<li><span class="math inline">\(R_L = 1/3 M\Omega\)</span></li>
<li><span class="math inline">\(g_{Na} = 1200 mS/mm^2\)</span></li>
</ul>
<p>Equations:<br />
<span class="math display">\[I_{ion} = g_{Na} \cdot m^3h(V_m-E_{Na}) + g_K \cdot n^4 (V_m-E_K) + g_L \cdot (V_m-E_L)\]</span>
<span class="math display">\[\frac{dn}{dt} = \alpha_n(V) \cdot (1-n) - \beta_n(V) \cdot(n)\]</span>
<span class="math display">\[\frac{dm}{dt} = \alpha_m(V) \cdot (1-m) - \beta_m(V) \cdot(m)\]</span>
<span class="math display">\[\frac{dh}{dt} = \alpha_h(V) \cdot (1-h) - \beta_h(V) \cdot(h)\]</span></p>
<p><em>Step 1: Determine necessary equations</em> The resting potential can be considered to be a steady state because the voltage is not changing. Therefore, <span class="math inline">\(\frac{dp}{dt}=0\)</span> for p={n, m, h} and therefore the last three equations will not be used.</p>
<p><em>Step 2: Calculate n, m, and h</em> We need to now use the resting potential to solve for the steady state values of the gating variables.<br />
<span class="math display">\[p_\infty = \frac{\alpha_p}{\alpha_p+\beta_p}\]</span>
for p = {n, m, h}</p>
<p>Therefore, we need to calculate each <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>.</p>
<p><span class="math display">\[ \alpha_{n}(V_{m}) = \frac{0.01(V_{m}+55)}{1-exp(-0.1(V_{m}+55))} \]</span>
<span class="math display">\[\alpha_{n}(V_{rest}) = \frac{0.01(-68+55)}{1-exp(-0.1(-68+55))} \]</span>
<span class="math display">\[\alpha_{n} = 0.049\]</span></p>
<p><span class="math display">\[\alpha_{m}(V_{m}) = \frac{0.1(V_{m}+40)}{1-exp(-0.1(V_{m}+40))}\]</span>
<span class="math display">\[\alpha_{m}(V_{rest}) = \frac{0.1(-68+40)}{1-exp(-0.1(-68+40))}\]</span>
<span class="math display">\[\alpha_{m}(V_{rest}) = 0.18\]</span></p>
<p><span class="math display">\[\alpha_{h}(V_{m}) = 0.07exp(-0.05(V_{m}+65)) \]</span>
<span class="math display">\[\alpha_{h}(V_{rest}) = 0.07 \cdot exp(-0.05 \cdot(-68+65)) \]</span>
<span class="math display">\[\alpha_{h}(V_{rest}) = 0.08\]</span></p>
<p><span class="math display">\[\beta_{n}(V_m) = 0.125exp(-0.0125(V_{m}+65)) \]</span>
<span class="math display">\[\beta_{n}(V_{rest}) = 0.125 \cdot exp(-0.0125 \cdot(-68+65)) \]</span>
<span class="math display">\[\beta_{n}(V_{rest}) = 0.13\]</span></p>
<p><span class="math display">\[\beta_{m}(V_{m}) = 4exp(-0.0556(V_{m}+65)) \]</span>
<span class="math display">\[\beta_{m}(V_{rest}) = 4 \cdot exp(-0.0556 \cdot(-68+65)) \]</span>
<span class="math display">\[\beta_{m}(V_{rest}) = 4.73\]</span></p>
<p><span class="math display">\[\beta_{h}(V_{m}) = \frac{1}{1+exp(-0.1(V_{m}+35))} \]</span>
<span class="math display">\[\beta_{h}(V_{rest}) = \frac{1}{1+exp(-0.1(-68+35))} \]</span>
<span class="math display">\[\beta_{h}(V_{rest}) = 0.036\]</span></p>
<p>Now, with each of our <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> values, we can calculate our gating variables:</p>
<p><span class="math display">\[n_\infty = \frac{\alpha_n}{\alpha_n+\beta_n}\]</span>
<span class="math display">\[n_\infty = \frac{0.049}{0.049+0.13} = 0.274\]</span></p>
<p><span class="math display">\[m_\infty = \frac{\alpha_m}{\alpha_m+\beta_m}\]</span>
<span class="math display">\[m_\infty = \frac{0.18}{0.18+4.73} = 0.037\]</span></p>
<p><span class="math display">\[h_\infty = \frac{\alpha_h}{\alpha_h+\beta_h}\]</span>
<span class="math display">\[h_\infty = \frac{0.08}{0.08+0.036} = 0.690\]</span></p>
<p><em>Step 3: Calculate <span class="math inline">\(g_L\)</span> from resistance units</em>. Remember that <span class="math inline">\(g = \frac{1}{R}\)</span>!
<span class="math display">\[g_L = (1/R) = (1/(1/3)) = 3 mS/mm^2\]</span>
<em>Step 4: Solve for <span class="math inline">\(g_K\)</span></em> Kirchhoff’s Law states that the algebraic sum of all the currents entering and leaving a junction must be equal to 0. Therefore:</p>
<p><span class="math display">\[0 = g_{Na} \cdot m^3h(V_m-E_{Na}) + g_K \cdot n^4 (V_m-E_K) + g_L \cdot (V_m-E_L)\]</span>
And we may plug in the values that we already have:<br />
<span class="math display">\[0 = 1200 \cdot 0.037^30.69 \cdot(-68-50) + g_K \cdot 0.274^4 \cdot (-68--77) + 3 \cdot (-68--54.387)\]</span>
<span class="math display">\[0 = 4.956 + g_K \cdot 0.051 + (-40.84)\]</span>
<span class="math display">\[g_K = 703.6\]</span></p>
<p><strong>Worked Example:</strong>
The voltage of a neuron is clamped at -20 mV, depolarized from its resting potential of -65 mV. The steady-state values of the gating variables in the two conditions are shown below. Comment on what these changes mean for the neuron’s behavior.</p>
<table>
<thead>
<tr class="header">
<th>V=-65 mV</th>
<th>V=-20mV</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>m=0.0529</td>
<td>m=0.875</td>
</tr>
<tr class="even">
<td>n=0.3177</td>
<td>n=0.820</td>
</tr>
<tr class="odd">
<td>h=0.5961</td>
<td>h=0.009</td>
</tr>
</tbody>
</table>
<p><em>Answer</em> The value of <em>m</em> represents the probability of voltage-gated Na+ channels to be open, which increases as the cell depolarizes. The <em>n</em> value represents the probability that the voltage-gated K+ channel is open and also increases with depolarization, but not to the same extent because K+ channels are slower to open and close. The <em>h</em> values represent the probability of Na+ channel inactivation, which decreases significantly with depolarization because we have not hit the peak of the action potential. As a result, it is fair to assume that the <em>h</em> value will increase as we approach the peak of the action potential.</p>
</div>
<div id="summary-3" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Summary<a href="Ch4.html#summary-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this chapter, we discuss Hodgkin and Huxley’s journey to discovery, the intricacies of their method, and will later examine some modern applications of their model through code. Using the voltage-clamp technique and squid axons as their vehicle of study, the two scientists were able to provide a model for the biological mechanisms of neuronal firing in an action potential. Additionally, by implementing voltage-gated sodium and potassium pumps, Hodgkin and Huxley were able to create a model that was much more accurate than the leaky integrate and fire model discussed in the previous chapter. Hodgkin and Huxley’s work continues to serve as a fundamental model of computational neuroscience, but still fails to account for the irregular firing rate of an actual neuron.</p>
</div>
<div id="exercises-2" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Exercises:<a href="Ch4.html#exercises-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="conceptual-exercises-1" class="section level3 hasAnchor" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Conceptual Exercises:<a href="Ch4.html#conceptual-exercises-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Describe the primary difference between the leaky integrate and fire model and the Hodgkin and Huxley model.<br />
</li>
<li>What do the gating variables <em>n</em>, <em>m</em>, and <em>h</em> represent? What does it mean when a gating variable has a higher or lower value?<br />
</li>
<li>What do the rate constants <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> represent?<br />
</li>
<li>Determine which of the variables in the Hodgkin and Huxley model are constants, given, or need to be solved for. Then, determine the order in which to solve for the unknown variables.</li>
</ol>
</div>
<div id="coding-exercises-1" class="section level3 hasAnchor" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> Coding Exercises:<a href="Ch4.html#coding-exercises-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Welcome to the coding problems for the Hodgkin and Huxley model! These exercises will help you get comfortable with using the Hodgkin and Huxley Model in different settings. To get started, simply run the following cell to create a few custom functions that we will be using for these exercises. A brief description of the functions can be found below:</p>
<ul>
<li>HHmodel: Calculates and plots the Hodgkin-Huxley model with parameters that we will pass through the function. These parameters include the injected current (Ie), time steps (dt), the final time interval (tFinal), the time at which the stimulus starts (tStimStart), the time as which the stimulus ends (tStimEnd), and the resting potential of the neuron (RestingPotential).</li>
<li>HHmodel_threshold: Determines whether or not an injected current that we pass through the function reaches the required threshold potential to fire. The only parameter of this function is the injected current (Ie).</li>
<li>HHmodel_compare: Compares differences in neuronal activity when injected with different currents. The parameters of this function include the injected currents (Ie) and the resting potential of the neuron (RestingPotential).</li>
</ul>
<p>No changes to the code are needed, and there is no expected output at this time, but feel free to look through the code and descriptive comments to see how each aspect of the model is implemented!</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="Ch4.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import necessary libraries</span></span>
<span id="cb1-2"><a href="Ch4.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="Ch4.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="Ch4.html#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="Ch4.html#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Creates a custom Hodgkin and Huxley function</span></span>
<span id="cb1-6"><a href="Ch4.html#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> HHmodel(Ie, dt, tFinal, tStimStart, tStimEnd, RestingPotential):</span>
<span id="cb1-7"><a href="Ch4.html#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-8"><a href="Ch4.html#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Defines the model parameters</span></span>
<span id="cb1-9"><a href="Ch4.html#cb1-9" aria-hidden="true" tabindex="-1"></a>    c     <span class="op">=</span>  <span class="dv">10</span> <span class="co"># capacitance per unit area (nF/mm^2)</span></span>
<span id="cb1-10"><a href="Ch4.html#cb1-10" aria-hidden="true" tabindex="-1"></a>    gMaxL <span class="op">=</span>  <span class="dv">3</span> <span class="co"># leak maximal conductance per unit area (mS/mm^2)</span></span>
<span id="cb1-11"><a href="Ch4.html#cb1-11" aria-hidden="true" tabindex="-1"></a>    EL    <span class="op">=</span>  <span class="op">-</span><span class="fl">54.387</span> <span class="co"># leak conductance reversal potential (mV)</span></span>
<span id="cb1-12"><a href="Ch4.html#cb1-12" aria-hidden="true" tabindex="-1"></a>    gMaxK <span class="op">=</span>  <span class="dv">360</span> <span class="co"># maximal K conductance per unit area (mS/mm^2)</span></span>
<span id="cb1-13"><a href="Ch4.html#cb1-13" aria-hidden="true" tabindex="-1"></a>    EK    <span class="op">=</span>  <span class="op">-</span><span class="dv">77</span> <span class="co"># K conductance reversal potential (mV)</span></span>
<span id="cb1-14"><a href="Ch4.html#cb1-14" aria-hidden="true" tabindex="-1"></a>    gMaxNa<span class="op">=</span>  <span class="dv">1200</span> <span class="co"># maximal Na conductance per unit area (mS/mm^2)</span></span>
<span id="cb1-15"><a href="Ch4.html#cb1-15" aria-hidden="true" tabindex="-1"></a>    ENa   <span class="op">=</span>  <span class="dv">50</span> <span class="co"># Na conductance reversal potential (mV)</span></span>
<span id="cb1-16"><a href="Ch4.html#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="Ch4.html#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sets up data structures to hold relevant variable vectors</span></span>
<span id="cb1-18"><a href="Ch4.html#cb1-18" aria-hidden="true" tabindex="-1"></a>    timeVec <span class="op">=</span> np.arange(<span class="dv">0</span>,tFinal, dt)</span>
<span id="cb1-19"><a href="Ch4.html#cb1-19" aria-hidden="true" tabindex="-1"></a>    voltageVector <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb1-20"><a href="Ch4.html#cb1-20" aria-hidden="true" tabindex="-1"></a>    Ivector <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb1-21"><a href="Ch4.html#cb1-21" aria-hidden="true" tabindex="-1"></a>    mVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb1-22"><a href="Ch4.html#cb1-22" aria-hidden="true" tabindex="-1"></a>    hVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb1-23"><a href="Ch4.html#cb1-23" aria-hidden="true" tabindex="-1"></a>    nVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb1-24"><a href="Ch4.html#cb1-24" aria-hidden="true" tabindex="-1"></a>    tauVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb1-25"><a href="Ch4.html#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="Ch4.html#cb1-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># assigns the initial value of each variable</span></span>
<span id="cb1-27"><a href="Ch4.html#cb1-27" aria-hidden="true" tabindex="-1"></a>    voltageVector[<span class="dv">0</span>] <span class="op">=</span>  RestingPotential </span>
<span id="cb1-28"><a href="Ch4.html#cb1-28" aria-hidden="true" tabindex="-1"></a>    mVec[<span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.0529</span></span>
<span id="cb1-29"><a href="Ch4.html#cb1-29" aria-hidden="true" tabindex="-1"></a>    hVec[<span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.5961</span></span>
<span id="cb1-30"><a href="Ch4.html#cb1-30" aria-hidden="true" tabindex="-1"></a>    nVec[<span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.3177</span></span>
<span id="cb1-31"><a href="Ch4.html#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="Ch4.html#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># defines the stimulus</span></span>
<span id="cb1-33"><a href="Ch4.html#cb1-33" aria-hidden="true" tabindex="-1"></a>    tStimStart <span class="op">=</span> <span class="bu">int</span>(tStimStart<span class="op">/</span>dt) </span>
<span id="cb1-34"><a href="Ch4.html#cb1-34" aria-hidden="true" tabindex="-1"></a>    tStimEnd <span class="op">=</span> <span class="bu">int</span>(tStimEnd<span class="op">/</span>dt) </span>
<span id="cb1-35"><a href="Ch4.html#cb1-35" aria-hidden="true" tabindex="-1"></a>    Ivector[tStimStart:tStimEnd] <span class="op">=</span> Ie </span>
<span id="cb1-36"><a href="Ch4.html#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="Ch4.html#cb1-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For-loop integrates equations into model</span></span>
<span id="cb1-38"><a href="Ch4.html#cb1-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> v <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(timeVec)<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb1-39"><a href="Ch4.html#cb1-39" aria-hidden="true" tabindex="-1"></a>      <span class="co"># We include -1 because we already have the first value</span></span>
<span id="cb1-40"><a href="Ch4.html#cb1-40" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-41"><a href="Ch4.html#cb1-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculates alpha values for m, h, and n</span></span>
<span id="cb1-42"><a href="Ch4.html#cb1-42" aria-hidden="true" tabindex="-1"></a>        alpha_n <span class="op">=</span> <span class="fl">0.01</span><span class="op">*</span>(voltageVector[v] <span class="op">+</span> <span class="dv">55</span>) <span class="op">/</span> </span>
<span id="cb1-43"><a href="Ch4.html#cb1-43" aria-hidden="true" tabindex="-1"></a>          (<span class="dv">1</span><span class="op">-</span>np.exp(<span class="op">-</span><span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">55</span>)))</span>
<span id="cb1-44"><a href="Ch4.html#cb1-44" aria-hidden="true" tabindex="-1"></a>        alpha_m <span class="op">=</span> (<span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">40</span>))<span class="op">/</span></span>
<span id="cb1-45"><a href="Ch4.html#cb1-45" aria-hidden="true" tabindex="-1"></a>          (<span class="dv">1</span><span class="op">-</span>np.exp(<span class="op">-</span><span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">40</span>)))</span>
<span id="cb1-46"><a href="Ch4.html#cb1-46" aria-hidden="true" tabindex="-1"></a>        alpha_h <span class="op">=</span> <span class="fl">0.07</span><span class="op">*</span>np.exp(<span class="op">-</span><span class="fl">.05</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">65</span>))</span>
<span id="cb1-47"><a href="Ch4.html#cb1-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-48"><a href="Ch4.html#cb1-48" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculates beta values for m, h, and n</span></span>
<span id="cb1-49"><a href="Ch4.html#cb1-49" aria-hidden="true" tabindex="-1"></a>        beta_n <span class="op">=</span> <span class="fl">0.125</span><span class="op">*</span>np.exp(<span class="op">-</span><span class="fl">.01125</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">55</span>))</span>
<span id="cb1-50"><a href="Ch4.html#cb1-50" aria-hidden="true" tabindex="-1"></a>        beta_m <span class="op">=</span> <span class="dv">4</span><span class="op">*</span>np.exp(<span class="op">-</span><span class="fl">.05556</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">65</span>))</span>
<span id="cb1-51"><a href="Ch4.html#cb1-51" aria-hidden="true" tabindex="-1"></a>        beta_h <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span><span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">35</span>)))</span>
<span id="cb1-52"><a href="Ch4.html#cb1-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-53"><a href="Ch4.html#cb1-53" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculates tau (time constant) values for m, h, and n</span></span>
<span id="cb1-54"><a href="Ch4.html#cb1-54" aria-hidden="true" tabindex="-1"></a>        tau_n <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (alpha_n <span class="op">+</span> beta_n)</span>
<span id="cb1-55"><a href="Ch4.html#cb1-55" aria-hidden="true" tabindex="-1"></a>        tau_m <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (alpha_m <span class="op">+</span> beta_m)</span>
<span id="cb1-56"><a href="Ch4.html#cb1-56" aria-hidden="true" tabindex="-1"></a>        tau_h <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (alpha_h <span class="op">+</span> beta_h)</span>
<span id="cb1-57"><a href="Ch4.html#cb1-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-58"><a href="Ch4.html#cb1-58" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculates infinity values for m, h, and n</span></span>
<span id="cb1-59"><a href="Ch4.html#cb1-59" aria-hidden="true" tabindex="-1"></a>        pm <span class="op">=</span> alpha_m<span class="op">/</span>(alpha_m <span class="op">+</span> beta_m)</span>
<span id="cb1-60"><a href="Ch4.html#cb1-60" aria-hidden="true" tabindex="-1"></a>        pn <span class="op">=</span> alpha_n<span class="op">/</span>(alpha_n<span class="op">+</span> beta_n)</span>
<span id="cb1-61"><a href="Ch4.html#cb1-61" aria-hidden="true" tabindex="-1"></a>        ph <span class="op">=</span> alpha_h<span class="op">/</span>(alpha_h <span class="op">+</span> beta_h)</span>
<span id="cb1-62"><a href="Ch4.html#cb1-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-63"><a href="Ch4.html#cb1-63" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculates and store values in m, h, and n vectors</span></span>
<span id="cb1-64"><a href="Ch4.html#cb1-64" aria-hidden="true" tabindex="-1"></a>        mVec[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> pm <span class="op">+</span> (mVec[v] <span class="op">-</span> pm)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tau_m)</span>
<span id="cb1-65"><a href="Ch4.html#cb1-65" aria-hidden="true" tabindex="-1"></a>        nVec[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> pn <span class="op">+</span> (nVec[v] <span class="op">-</span> pn)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tau_n)</span>
<span id="cb1-66"><a href="Ch4.html#cb1-66" aria-hidden="true" tabindex="-1"></a>        hVec[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> ph <span class="op">+</span> (hVec[v] <span class="op">-</span> ph)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tau_h)</span>
<span id="cb1-67"><a href="Ch4.html#cb1-67" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-68"><a href="Ch4.html#cb1-68" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Updates Vinf and tauV</span></span>
<span id="cb1-69"><a href="Ch4.html#cb1-69" aria-hidden="true" tabindex="-1"></a>        denominator <span class="op">=</span> gMaxL <span class="op">+</span> gMaxK<span class="op">*</span>(nVec[v]<span class="op">**</span><span class="dv">4</span>) <span class="op">+</span> </span>
<span id="cb1-70"><a href="Ch4.html#cb1-70" aria-hidden="true" tabindex="-1"></a>          gMaxNa<span class="op">*</span>(mVec[v]<span class="op">**</span><span class="dv">3</span>)<span class="op">*</span>hVec[v]</span>
<span id="cb1-71"><a href="Ch4.html#cb1-71" aria-hidden="true" tabindex="-1"></a>        tauV <span class="op">=</span> c <span class="op">/</span> denominator</span>
<span id="cb1-72"><a href="Ch4.html#cb1-72" aria-hidden="true" tabindex="-1"></a>        Vinf <span class="op">=</span> ((gMaxL)<span class="op">*</span>EL <span class="op">+</span> gMaxK<span class="op">*</span>(nVec[v]<span class="op">**</span><span class="dv">4</span>)<span class="op">*</span>EK <span class="op">+</span> <span class="op">\</span></span>
<span id="cb1-73"><a href="Ch4.html#cb1-73" aria-hidden="true" tabindex="-1"></a>          gMaxNa<span class="op">*</span>(mVec[v]<span class="op">**</span><span class="dv">3</span>)<span class="op">*</span>hVec[v]<span class="op">*</span>ENa <span class="op">+</span> Ivector[v])<span class="op">/</span>denominator  </span>
<span id="cb1-74"><a href="Ch4.html#cb1-74" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-75"><a href="Ch4.html#cb1-75" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculates and store next voltage value in vector</span></span>
<span id="cb1-76"><a href="Ch4.html#cb1-76" aria-hidden="true" tabindex="-1"></a>        voltageVector[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> Vinf <span class="op">+</span> (voltageVector[v]<span class="op">-</span>Vinf)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tauV) </span>
<span id="cb1-77"><a href="Ch4.html#cb1-77" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-78"><a href="Ch4.html#cb1-78" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plotting</span></span>
<span id="cb1-79"><a href="Ch4.html#cb1-79" aria-hidden="true" tabindex="-1"></a>    plt.figure(<span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">10</span>))</span>
<span id="cb1-80"><a href="Ch4.html#cb1-80" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb1-81"><a href="Ch4.html#cb1-81" aria-hidden="true" tabindex="-1"></a>    plt.plot(timeVec,voltageVector)</span>
<span id="cb1-82"><a href="Ch4.html#cb1-82" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&#39;Hodgkin and Huxley Simulation&#39;</span>)</span>
<span id="cb1-83"><a href="Ch4.html#cb1-83" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;Voltage in mV&#39;</span>)</span>
<span id="cb1-84"><a href="Ch4.html#cb1-84" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb1-85"><a href="Ch4.html#cb1-85" aria-hidden="true" tabindex="-1"></a>    plt.plot(timeVec, mVec)</span>
<span id="cb1-86"><a href="Ch4.html#cb1-86" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;g_Na activation variable m&#39;</span>)</span>
<span id="cb1-87"><a href="Ch4.html#cb1-87" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb1-88"><a href="Ch4.html#cb1-88" aria-hidden="true" tabindex="-1"></a>    plt.plot(timeVec, hVec)</span>
<span id="cb1-89"><a href="Ch4.html#cb1-89" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;g_Na inactivation variable h&#39;</span>)</span>
<span id="cb1-90"><a href="Ch4.html#cb1-90" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">4</span>)</span>
<span id="cb1-91"><a href="Ch4.html#cb1-91" aria-hidden="true" tabindex="-1"></a>    plt.plot(timeVec, nVec)</span>
<span id="cb1-92"><a href="Ch4.html#cb1-92" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;g_K activation variable&#39;</span>)</span>
<span id="cb1-93"><a href="Ch4.html#cb1-93" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">&#39;Time in ms&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="Ch4.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#creates a custom function that will determine the minimum Ie</span></span>
<span id="cb2-2"><a href="Ch4.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># required to surpass the threshold potential</span></span>
<span id="cb2-3"><a href="Ch4.html#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="Ch4.html#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> HHmodel_threshold(Ie):</span>
<span id="cb2-5"><a href="Ch4.html#cb2-5" aria-hidden="true" tabindex="-1"></a>    tStimStart <span class="op">=</span> <span class="dv">250</span></span>
<span id="cb2-6"><a href="Ch4.html#cb2-6" aria-hidden="true" tabindex="-1"></a>    tStimEnd   <span class="op">=</span> <span class="dv">750</span></span>
<span id="cb2-7"><a href="Ch4.html#cb2-7" aria-hidden="true" tabindex="-1"></a>    dt          <span class="op">=</span> <span class="fl">0.1</span> <span class="co"># time step (ms)</span></span>
<span id="cb2-8"><a href="Ch4.html#cb2-8" aria-hidden="true" tabindex="-1"></a>    tFinal      <span class="op">=</span> <span class="dv">1000</span> <span class="co"># total time of run (ms)</span></span>
<span id="cb2-9"><a href="Ch4.html#cb2-9" aria-hidden="true" tabindex="-1"></a>    RestingPotential <span class="op">=</span> <span class="op">-</span><span class="dv">65</span></span>
<span id="cb2-10"><a href="Ch4.html#cb2-10" aria-hidden="true" tabindex="-1"></a>    c     <span class="op">=</span> <span class="dv">10</span> <span class="co"># capacitance per unit area (nF/mm^2)</span></span>
<span id="cb2-11"><a href="Ch4.html#cb2-11" aria-hidden="true" tabindex="-1"></a>    gMaxL <span class="op">=</span> <span class="dv">3</span> <span class="co"># leak maximal conductance per unit area (mS/mm^2)</span></span>
<span id="cb2-12"><a href="Ch4.html#cb2-12" aria-hidden="true" tabindex="-1"></a>    EL    <span class="op">=</span>  <span class="op">-</span><span class="fl">54.387</span> <span class="co"># leak conductance reversal potential (mV)</span></span>
<span id="cb2-13"><a href="Ch4.html#cb2-13" aria-hidden="true" tabindex="-1"></a>    gMaxK <span class="op">=</span>  <span class="dv">360</span> <span class="co"># maximal K conductance per unit area (mS/mm^2)</span></span>
<span id="cb2-14"><a href="Ch4.html#cb2-14" aria-hidden="true" tabindex="-1"></a>    EK    <span class="op">=</span>  <span class="op">-</span><span class="dv">77</span> <span class="co"># K conductance reversal potential (mV)</span></span>
<span id="cb2-15"><a href="Ch4.html#cb2-15" aria-hidden="true" tabindex="-1"></a>    gMaxNa<span class="op">=</span>  <span class="dv">1200</span> <span class="co"># maximal Na conductance per unit area (mS/mm^2)</span></span>
<span id="cb2-16"><a href="Ch4.html#cb2-16" aria-hidden="true" tabindex="-1"></a>    ENa   <span class="op">=</span>  <span class="dv">50</span> <span class="co"># Na conductance reversal potential (mV)</span></span>
<span id="cb2-17"><a href="Ch4.html#cb2-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-18"><a href="Ch4.html#cb2-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-19"><a href="Ch4.html#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(Ie)):</span>
<span id="cb2-20"><a href="Ch4.html#cb2-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-21"><a href="Ch4.html#cb2-21" aria-hidden="true" tabindex="-1"></a>        timeVec <span class="op">=</span> np.arange(<span class="dv">0</span>,tFinal, dt)</span>
<span id="cb2-22"><a href="Ch4.html#cb2-22" aria-hidden="true" tabindex="-1"></a>        voltageVector <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb2-23"><a href="Ch4.html#cb2-23" aria-hidden="true" tabindex="-1"></a>        Ivector <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb2-24"><a href="Ch4.html#cb2-24" aria-hidden="true" tabindex="-1"></a>        mVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb2-25"><a href="Ch4.html#cb2-25" aria-hidden="true" tabindex="-1"></a>        hVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb2-26"><a href="Ch4.html#cb2-26" aria-hidden="true" tabindex="-1"></a>        nVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb2-27"><a href="Ch4.html#cb2-27" aria-hidden="true" tabindex="-1"></a>        tauVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb2-28"><a href="Ch4.html#cb2-28" aria-hidden="true" tabindex="-1"></a>        voltageVector[<span class="dv">0</span>] <span class="op">=</span>  RestingPotential </span>
<span id="cb2-29"><a href="Ch4.html#cb2-29" aria-hidden="true" tabindex="-1"></a>        mVec[<span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.0529</span></span>
<span id="cb2-30"><a href="Ch4.html#cb2-30" aria-hidden="true" tabindex="-1"></a>        hVec[<span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.5961</span></span>
<span id="cb2-31"><a href="Ch4.html#cb2-31" aria-hidden="true" tabindex="-1"></a>        nVec[<span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.3177</span></span>
<span id="cb2-32"><a href="Ch4.html#cb2-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-33"><a href="Ch4.html#cb2-33" aria-hidden="true" tabindex="-1"></a>        Ivector[<span class="dv">2499</span>:<span class="dv">7499</span>] <span class="op">=</span> Ie[current]</span>
<span id="cb2-34"><a href="Ch4.html#cb2-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-35"><a href="Ch4.html#cb2-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> v <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(timeVec)<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb2-36"><a href="Ch4.html#cb2-36" aria-hidden="true" tabindex="-1"></a>            alpha_n <span class="op">=</span> <span class="fl">0.01</span><span class="op">*</span>(voltageVector[v] <span class="op">+</span> <span class="dv">55</span>)<span class="op">/</span> \ </span>
<span id="cb2-37"><a href="Ch4.html#cb2-37" aria-hidden="true" tabindex="-1"></a>              (<span class="dv">1</span><span class="op">-</span>np.exp(<span class="op">-</span><span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">55</span>)))</span>
<span id="cb2-38"><a href="Ch4.html#cb2-38" aria-hidden="true" tabindex="-1"></a>            alpha_m <span class="op">=</span> (<span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">40</span>))<span class="op">/</span> <span class="op">\</span></span>
<span id="cb2-39"><a href="Ch4.html#cb2-39" aria-hidden="true" tabindex="-1"></a>              (<span class="dv">1</span><span class="op">-</span>np.exp(<span class="op">-</span><span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">40</span>)))</span>
<span id="cb2-40"><a href="Ch4.html#cb2-40" aria-hidden="true" tabindex="-1"></a>            alpha_h <span class="op">=</span> <span class="fl">0.07</span><span class="op">*</span>np.exp(<span class="op">-</span><span class="fl">.05</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">65</span>))</span>
<span id="cb2-41"><a href="Ch4.html#cb2-41" aria-hidden="true" tabindex="-1"></a>            beta_n <span class="op">=</span> <span class="fl">0.125</span><span class="op">*</span>np.exp(<span class="op">-</span><span class="fl">.01125</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">55</span>))</span>
<span id="cb2-42"><a href="Ch4.html#cb2-42" aria-hidden="true" tabindex="-1"></a>            beta_m <span class="op">=</span> <span class="dv">4</span><span class="op">*</span>np.exp(<span class="op">-</span><span class="fl">.05556</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">65</span>))</span>
<span id="cb2-43"><a href="Ch4.html#cb2-43" aria-hidden="true" tabindex="-1"></a>            beta_h <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span><span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">35</span>)))</span>
<span id="cb2-44"><a href="Ch4.html#cb2-44" aria-hidden="true" tabindex="-1"></a>            tau_n <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (alpha_n <span class="op">+</span> beta_n)</span>
<span id="cb2-45"><a href="Ch4.html#cb2-45" aria-hidden="true" tabindex="-1"></a>            tau_m <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (alpha_m <span class="op">+</span> beta_m)</span>
<span id="cb2-46"><a href="Ch4.html#cb2-46" aria-hidden="true" tabindex="-1"></a>            tau_h <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (alpha_h <span class="op">+</span> beta_h)</span>
<span id="cb2-47"><a href="Ch4.html#cb2-47" aria-hidden="true" tabindex="-1"></a>            pm <span class="op">=</span> alpha_m<span class="op">/</span>(alpha_m <span class="op">+</span> beta_m)</span>
<span id="cb2-48"><a href="Ch4.html#cb2-48" aria-hidden="true" tabindex="-1"></a>            pn <span class="op">=</span> alpha_n<span class="op">/</span>(alpha_n<span class="op">+</span> beta_n)</span>
<span id="cb2-49"><a href="Ch4.html#cb2-49" aria-hidden="true" tabindex="-1"></a>            ph <span class="op">=</span> alpha_h<span class="op">/</span>(alpha_h <span class="op">+</span> beta_h)</span>
<span id="cb2-50"><a href="Ch4.html#cb2-50" aria-hidden="true" tabindex="-1"></a>            mVec[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> pm <span class="op">+</span> (mVec[v] <span class="op">-</span> pm)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tau_m)</span>
<span id="cb2-51"><a href="Ch4.html#cb2-51" aria-hidden="true" tabindex="-1"></a>            nVec[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> pn <span class="op">+</span> (nVec[v] <span class="op">-</span> pn)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tau_n)</span>
<span id="cb2-52"><a href="Ch4.html#cb2-52" aria-hidden="true" tabindex="-1"></a>            hVec[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> ph <span class="op">+</span> (hVec[v] <span class="op">-</span> ph)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tau_h)</span>
<span id="cb2-53"><a href="Ch4.html#cb2-53" aria-hidden="true" tabindex="-1"></a>            denominator <span class="op">=</span> gMaxL <span class="op">+</span> gMaxK<span class="op">*</span>(nVec[v]<span class="op">**</span><span class="dv">4</span>) <span class="op">+</span> </span>
<span id="cb2-54"><a href="Ch4.html#cb2-54" aria-hidden="true" tabindex="-1"></a>              gMaxNa<span class="op">*</span>(mVec[v]<span class="op">**</span><span class="dv">3</span>)<span class="op">*</span>hVec[v]</span>
<span id="cb2-55"><a href="Ch4.html#cb2-55" aria-hidden="true" tabindex="-1"></a>            tauV <span class="op">=</span> c <span class="op">/</span> denominator</span>
<span id="cb2-56"><a href="Ch4.html#cb2-56" aria-hidden="true" tabindex="-1"></a>            Vinf <span class="op">=</span> ((gMaxL)<span class="op">*</span>EL <span class="op">+</span> gMaxK<span class="op">*</span>(nVec[v]<span class="op">**</span><span class="dv">4</span>)<span class="op">*</span>EK <span class="op">+</span> <span class="op">\</span></span>
<span id="cb2-57"><a href="Ch4.html#cb2-57" aria-hidden="true" tabindex="-1"></a>              gMaxNa<span class="op">*</span>(mVec[v]<span class="op">**</span><span class="dv">3</span>)<span class="op">*</span>hVec[v]<span class="op">*</span>ENa <span class="op">+</span> Ivector[v])<span class="op">/</span> denominator   </span>
<span id="cb2-58"><a href="Ch4.html#cb2-58" aria-hidden="true" tabindex="-1"></a>            voltageVector[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> Vinf <span class="op">+</span> <span class="op">\</span></span>
<span id="cb2-59"><a href="Ch4.html#cb2-59" aria-hidden="true" tabindex="-1"></a>              (voltageVector[v]<span class="op">-</span>Vinf)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tauV) </span>
<span id="cb2-60"><a href="Ch4.html#cb2-60" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-61"><a href="Ch4.html#cb2-61" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Checks to see if the given current resulted in an </span></span>
<span id="cb2-62"><a href="Ch4.html#cb2-62" aria-hidden="true" tabindex="-1"></a>            <span class="co"># action potential </span></span>
<span id="cb2-63"><a href="Ch4.html#cb2-63" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Values around 25 mv is only reached if the neuron spikes. </span></span>
<span id="cb2-64"><a href="Ch4.html#cb2-64" aria-hidden="true" tabindex="-1"></a>            <span class="co"># A value of 20 would similarly be appropriate</span></span>
<span id="cb2-65"><a href="Ch4.html#cb2-65" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> voltageVector[v] <span class="op">&gt;</span> <span class="dv">25</span>: </span>
<span id="cb2-66"><a href="Ch4.html#cb2-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span>(<span class="bu">print</span>(<span class="st">&quot;With an external current of&quot;</span>, Ie[current]<span class="op">-</span><span class="dv">1</span> ,</span>
<span id="cb2-67"><a href="Ch4.html#cb2-67" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;nA/mm^2 threshold potential was finally reached!&quot;</span>)) </span>
<span id="cb2-68"><a href="Ch4.html#cb2-68" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-69"><a href="Ch4.html#cb2-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>(<span class="bu">print</span>(<span class="st">&quot;Looks like you didn&#39;t provide a large value in your range </span></span>
<span id="cb2-70"><a href="Ch4.html#cb2-70" aria-hidden="true" tabindex="-1"></a><span class="er">      caused the neuron to spike. Try again!&quot;))</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="Ch4.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plots the behavior of a neuron when injected with different </span></span>
<span id="cb3-2"><a href="Ch4.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># currents on the same graphs</span></span>
<span id="cb3-3"><a href="Ch4.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> HHmodel_compare(Ie, RestingPotential):</span>
<span id="cb3-4"><a href="Ch4.html#cb3-4" aria-hidden="true" tabindex="-1"></a>    terminate <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb3-5"><a href="Ch4.html#cb3-5" aria-hidden="true" tabindex="-1"></a>    tStimStart  <span class="op">=</span>  <span class="dv">10</span> </span>
<span id="cb3-6"><a href="Ch4.html#cb3-6" aria-hidden="true" tabindex="-1"></a>    tStimEnd    <span class="op">=</span>  <span class="dv">30</span> </span>
<span id="cb3-7"><a href="Ch4.html#cb3-7" aria-hidden="true" tabindex="-1"></a>    tFinal      <span class="op">=</span>  <span class="dv">50</span> </span>
<span id="cb3-8"><a href="Ch4.html#cb3-8" aria-hidden="true" tabindex="-1"></a>    dt          <span class="op">=</span>  <span class="fl">0.002</span> </span>
<span id="cb3-9"><a href="Ch4.html#cb3-9" aria-hidden="true" tabindex="-1"></a>    c           <span class="op">=</span>  <span class="dv">10</span> </span>
<span id="cb3-10"><a href="Ch4.html#cb3-10" aria-hidden="true" tabindex="-1"></a>    gMaxL       <span class="op">=</span>  <span class="fl">0.003e03</span> </span>
<span id="cb3-11"><a href="Ch4.html#cb3-11" aria-hidden="true" tabindex="-1"></a>    EL          <span class="op">=</span>  <span class="op">-</span><span class="fl">54.387</span> </span>
<span id="cb3-12"><a href="Ch4.html#cb3-12" aria-hidden="true" tabindex="-1"></a>    gMaxK       <span class="op">=</span>  <span class="fl">0.36e03</span> </span>
<span id="cb3-13"><a href="Ch4.html#cb3-13" aria-hidden="true" tabindex="-1"></a>    EK          <span class="op">=</span>  <span class="op">-</span><span class="dv">77</span> </span>
<span id="cb3-14"><a href="Ch4.html#cb3-14" aria-hidden="true" tabindex="-1"></a>    gMaxNa      <span class="op">=</span>  <span class="fl">1.2e03</span> </span>
<span id="cb3-15"><a href="Ch4.html#cb3-15" aria-hidden="true" tabindex="-1"></a>    ENa         <span class="op">=</span>  <span class="dv">50</span> </span>
<span id="cb3-16"><a href="Ch4.html#cb3-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-17"><a href="Ch4.html#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(Ie)):</span>
<span id="cb3-18"><a href="Ch4.html#cb3-18" aria-hidden="true" tabindex="-1"></a>        timeVec <span class="op">=</span> np.arange(<span class="dv">0</span>,tFinal, dt)</span>
<span id="cb3-19"><a href="Ch4.html#cb3-19" aria-hidden="true" tabindex="-1"></a>        voltageVector <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb3-20"><a href="Ch4.html#cb3-20" aria-hidden="true" tabindex="-1"></a>        Ivector <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb3-21"><a href="Ch4.html#cb3-21" aria-hidden="true" tabindex="-1"></a>        mVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb3-22"><a href="Ch4.html#cb3-22" aria-hidden="true" tabindex="-1"></a>        hVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb3-23"><a href="Ch4.html#cb3-23" aria-hidden="true" tabindex="-1"></a>        nVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb3-24"><a href="Ch4.html#cb3-24" aria-hidden="true" tabindex="-1"></a>        tauVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb3-25"><a href="Ch4.html#cb3-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-26"><a href="Ch4.html#cb3-26" aria-hidden="true" tabindex="-1"></a>        voltageVector[<span class="dv">0</span>] <span class="op">=</span> RestingPotential </span>
<span id="cb3-27"><a href="Ch4.html#cb3-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-28"><a href="Ch4.html#cb3-28" aria-hidden="true" tabindex="-1"></a>        mVec[<span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.0529</span></span>
<span id="cb3-29"><a href="Ch4.html#cb3-29" aria-hidden="true" tabindex="-1"></a>        hVec[<span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.5961</span></span>
<span id="cb3-30"><a href="Ch4.html#cb3-30" aria-hidden="true" tabindex="-1"></a>        nVec[<span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.3177</span></span>
<span id="cb3-31"><a href="Ch4.html#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="Ch4.html#cb3-32" aria-hidden="true" tabindex="-1"></a>        Ivector[<span class="dv">5000</span>:<span class="dv">15000</span>] <span class="op">=</span> Ie[current]</span>
<span id="cb3-33"><a href="Ch4.html#cb3-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-34"><a href="Ch4.html#cb3-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> v <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(timeVec)<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb3-35"><a href="Ch4.html#cb3-35" aria-hidden="true" tabindex="-1"></a>            alpha_n <span class="op">=</span> <span class="fl">0.01</span><span class="op">*</span>(voltageVector[v] <span class="op">+</span> <span class="dv">55</span>) <span class="op">/</span> <span class="op">\</span></span>
<span id="cb3-36"><a href="Ch4.html#cb3-36" aria-hidden="true" tabindex="-1"></a>              (<span class="dv">1</span><span class="op">-</span>np.exp(<span class="op">-</span><span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">55</span>)))</span>
<span id="cb3-37"><a href="Ch4.html#cb3-37" aria-hidden="true" tabindex="-1"></a>            alpha_m <span class="op">=</span> (<span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">40</span>))<span class="op">/</span> <span class="op">\</span></span>
<span id="cb3-38"><a href="Ch4.html#cb3-38" aria-hidden="true" tabindex="-1"></a>              (<span class="dv">1</span><span class="op">-</span>np.exp(<span class="op">-</span><span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">40</span>)))</span>
<span id="cb3-39"><a href="Ch4.html#cb3-39" aria-hidden="true" tabindex="-1"></a>            alpha_h <span class="op">=</span> <span class="fl">0.07</span><span class="op">*</span>np.exp(<span class="op">-</span><span class="fl">.05</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">65</span>))</span>
<span id="cb3-40"><a href="Ch4.html#cb3-40" aria-hidden="true" tabindex="-1"></a>            beta_n <span class="op">=</span> <span class="fl">0.125</span><span class="op">*</span>np.exp(<span class="op">-</span><span class="fl">.01125</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">55</span>))</span>
<span id="cb3-41"><a href="Ch4.html#cb3-41" aria-hidden="true" tabindex="-1"></a>            beta_m <span class="op">=</span> <span class="dv">4</span><span class="op">*</span>np.exp(<span class="op">-</span><span class="fl">.05556</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">65</span>))</span>
<span id="cb3-42"><a href="Ch4.html#cb3-42" aria-hidden="true" tabindex="-1"></a>            beta_h <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span><span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">35</span>)))</span>
<span id="cb3-43"><a href="Ch4.html#cb3-43" aria-hidden="true" tabindex="-1"></a>            tau_n <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (alpha_n <span class="op">+</span> beta_n)</span>
<span id="cb3-44"><a href="Ch4.html#cb3-44" aria-hidden="true" tabindex="-1"></a>            tau_m <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (alpha_m <span class="op">+</span> beta_m)</span>
<span id="cb3-45"><a href="Ch4.html#cb3-45" aria-hidden="true" tabindex="-1"></a>            tau_h <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (alpha_h <span class="op">+</span> beta_h)</span>
<span id="cb3-46"><a href="Ch4.html#cb3-46" aria-hidden="true" tabindex="-1"></a>            pm <span class="op">=</span> alpha_m<span class="op">/</span>(alpha_m <span class="op">+</span> beta_m)</span>
<span id="cb3-47"><a href="Ch4.html#cb3-47" aria-hidden="true" tabindex="-1"></a>            pn <span class="op">=</span> alpha_n<span class="op">/</span>(alpha_n<span class="op">+</span> beta_n)</span>
<span id="cb3-48"><a href="Ch4.html#cb3-48" aria-hidden="true" tabindex="-1"></a>            ph <span class="op">=</span> alpha_h<span class="op">/</span>(alpha_h <span class="op">+</span> beta_h)</span>
<span id="cb3-49"><a href="Ch4.html#cb3-49" aria-hidden="true" tabindex="-1"></a>            mVec[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> pm <span class="op">+</span> (mVec[v] <span class="op">-</span> pm)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tau_m)</span>
<span id="cb3-50"><a href="Ch4.html#cb3-50" aria-hidden="true" tabindex="-1"></a>            nVec[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> pn <span class="op">+</span> (nVec[v] <span class="op">-</span> pn)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tau_n)</span>
<span id="cb3-51"><a href="Ch4.html#cb3-51" aria-hidden="true" tabindex="-1"></a>            hVec[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> ph <span class="op">+</span> (hVec[v] <span class="op">-</span> ph)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tau_h)</span>
<span id="cb3-52"><a href="Ch4.html#cb3-52" aria-hidden="true" tabindex="-1"></a>            denominator <span class="op">=</span> gMaxL <span class="op">+</span> gMaxK<span class="op">*</span>(nVec[v]<span class="op">**</span><span class="dv">4</span>) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb3-53"><a href="Ch4.html#cb3-53" aria-hidden="true" tabindex="-1"></a>              gMaxNa<span class="op">*</span>(mVec[v]<span class="op">**</span><span class="dv">3</span>)<span class="op">*</span>hVec[v]</span>
<span id="cb3-54"><a href="Ch4.html#cb3-54" aria-hidden="true" tabindex="-1"></a>            tauV <span class="op">=</span> c <span class="op">/</span> denominator</span>
<span id="cb3-55"><a href="Ch4.html#cb3-55" aria-hidden="true" tabindex="-1"></a>            Vinf <span class="op">=</span> ((gMaxL)<span class="op">*</span>EL <span class="op">+</span> gMaxK<span class="op">*</span>(nVec[v]<span class="op">**</span><span class="dv">4</span>)<span class="op">*</span>EK <span class="op">+</span> <span class="op">\</span></span>
<span id="cb3-56"><a href="Ch4.html#cb3-56" aria-hidden="true" tabindex="-1"></a>              gMaxNa<span class="op">*</span>(mVec[v]<span class="op">**</span><span class="dv">3</span>)<span class="op">*</span>hVec[v]<span class="op">*</span>ENa <span class="op">+</span> Ivector[v])<span class="op">/</span> </span>
<span id="cb3-57"><a href="Ch4.html#cb3-57" aria-hidden="true" tabindex="-1"></a>                denominator   </span>
<span id="cb3-58"><a href="Ch4.html#cb3-58" aria-hidden="true" tabindex="-1"></a>            voltageVector[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> Vinf <span class="op">+</span> </span>
<span id="cb3-59"><a href="Ch4.html#cb3-59" aria-hidden="true" tabindex="-1"></a>              (voltageVector[v]<span class="op">-</span>Vinf)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tauV)</span>
<span id="cb3-60"><a href="Ch4.html#cb3-60" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-61"><a href="Ch4.html#cb3-61" aria-hidden="true" tabindex="-1"></a>            <span class="co"># stores values so the two plots can be superimposed</span></span>
<span id="cb3-62"><a href="Ch4.html#cb3-62" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> terminate <span class="op">==</span><span class="dv">0</span>:</span>
<span id="cb3-63"><a href="Ch4.html#cb3-63" aria-hidden="true" tabindex="-1"></a>                Mv <span class="op">=</span> mVec</span>
<span id="cb3-64"><a href="Ch4.html#cb3-64" aria-hidden="true" tabindex="-1"></a>                Nv <span class="op">=</span> nVec</span>
<span id="cb3-65"><a href="Ch4.html#cb3-65" aria-hidden="true" tabindex="-1"></a>                Hv <span class="op">=</span> hVec</span>
<span id="cb3-66"><a href="Ch4.html#cb3-66" aria-hidden="true" tabindex="-1"></a>                Vv <span class="op">=</span> voltageVector</span>
<span id="cb3-67"><a href="Ch4.html#cb3-67" aria-hidden="true" tabindex="-1"></a>                terminate <span class="op">=</span> <span class="dv">1</span> </span>
<span id="cb3-68"><a href="Ch4.html#cb3-68" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb3-69"><a href="Ch4.html#cb3-69" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plotting</span></span>
<span id="cb3-70"><a href="Ch4.html#cb3-70" aria-hidden="true" tabindex="-1"></a>    plt.figure(<span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">10</span>))</span>
<span id="cb3-71"><a href="Ch4.html#cb3-71" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb3-72"><a href="Ch4.html#cb3-72" aria-hidden="true" tabindex="-1"></a>    plt.plot(timeVec,voltageVector, timeVec, Vv)</span>
<span id="cb3-73"><a href="Ch4.html#cb3-73" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&#39;Hodgkin and Huxley Simulation&#39;</span>)</span>
<span id="cb3-74"><a href="Ch4.html#cb3-74" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;Voltage in mV&#39;</span>)</span>
<span id="cb3-75"><a href="Ch4.html#cb3-75" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb3-76"><a href="Ch4.html#cb3-76" aria-hidden="true" tabindex="-1"></a>    plt.plot(timeVec, mVec, timeVec, Mv)</span>
<span id="cb3-77"><a href="Ch4.html#cb3-77" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;g_Na activation variable m&#39;</span>)</span>
<span id="cb3-78"><a href="Ch4.html#cb3-78" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb3-79"><a href="Ch4.html#cb3-79" aria-hidden="true" tabindex="-1"></a>    plt.plot(timeVec, hVec, timeVec, Hv)</span>
<span id="cb3-80"><a href="Ch4.html#cb3-80" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;g_Na inactivation variable h&#39;</span>)</span>
<span id="cb3-81"><a href="Ch4.html#cb3-81" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">4</span>)</span>
<span id="cb3-82"><a href="Ch4.html#cb3-82" aria-hidden="true" tabindex="-1"></a>    plt.plot(timeVec, nVec, timeVec, Nv)</span>
<span id="cb3-83"><a href="Ch4.html#cb3-83" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;g_K activation variable&#39;</span>)</span>
<span id="cb3-84"><a href="Ch4.html#cb3-84" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">&#39;Time in ms&#39;</span>)</span>
<span id="cb3-85"><a href="Ch4.html#cb3-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-86"><a href="Ch4.html#cb3-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-87"><a href="Ch4.html#cb3-87" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Cell run successfully! Please proceed to the next part&quot;</span>)</span></code></pre></div>
<p><strong>Problem 1: Exploring the Model</strong>
<em>Part 1</em>
What can the model do? The function HHmodel() provides insight by simulating a neuron firing and the behavior of its channel gating variables under various conditions. Simulate an experiment that runs for 500 ms in which a neuron is exposed to a current of 100 <span class="math inline">\(nA/mm^2\)</span> from 100-400 ms. Use time steps of 0.1 ms and set the resting potential to -65 mV.</p>
<p>Note, the code has been started for you - set the variables to their specified values and run the code.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="Ch4.html#cb4-1" aria-hidden="true" tabindex="-1"></a>tStimStart  <span class="op">=</span>            <span class="co"># time to start injecting current (ms)</span></span>
<span id="cb4-2"><a href="Ch4.html#cb4-2" aria-hidden="true" tabindex="-1"></a>tStimEnd    <span class="op">=</span>            <span class="co"># time to end injecting current (ms)</span></span>
<span id="cb4-3"><a href="Ch4.html#cb4-3" aria-hidden="true" tabindex="-1"></a>tFinal      <span class="op">=</span>            <span class="co"># total time of run (ms)</span></span>
<span id="cb4-4"><a href="Ch4.html#cb4-4" aria-hidden="true" tabindex="-1"></a>dt          <span class="op">=</span>            <span class="co"># time step (ms)</span></span>
<span id="cb4-5"><a href="Ch4.html#cb4-5" aria-hidden="true" tabindex="-1"></a>Ie          <span class="op">=</span>            <span class="co"># nA/mm^2</span></span>
<span id="cb4-6"><a href="Ch4.html#cb4-6" aria-hidden="true" tabindex="-1"></a>RestingPotential <span class="op">=</span>       <span class="co">#mv</span></span>
<span id="cb4-7"><a href="Ch4.html#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="Ch4.html#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the custom function</span></span>
<span id="cb4-9"><a href="Ch4.html#cb4-9" aria-hidden="true" tabindex="-1"></a>HHmodel(Ie, dt, tFinal, tStimStart, tStimEnd, RestingPotential)</span></code></pre></div>
<p><em>Part 2</em> Nice work! Does increasing the injected current increasing the firing rate? Using the same code, increase the injected current to 250 <span class="math inline">\(nA/mm^2\)</span> to find out!</p>
<p><em>Part 3, optional</em> Play around with the parameters to see how changing the neuron’s starting conditions will affect its behavior!</p>
<p><strong>Problem 2: Threshold Potential</strong>
<em>Part 1</em> Neurons operate on a “all or nothing” basis, meaning they fire an action potential at full force or do not fire at all. The function HHmodel_threshold() takes different values of injected currents (<span class="math inline">\(I_e\)</span>) and returns the minimum value that elicited an action potential. Using <em>np.arange()</em>, set <span class="math inline">\(I_e\)</span> equal to a vector of increasing voltages to determine the minimum injected current required for the neuron to cross its threshold potential. Hint: first define your external stimulation, <span class="math inline">\(I_e\)</span> then use the HHmodel_threshold() function.</p>
<p><em>Part 2</em> The function HHmodel_compare() will plot the behavior of a neuron and its gating variables for two different injected current values. The function’s input is the array <span class="math inline">\(I_e\)</span> that contains two values. Using the external current determined in part one and the preceding integer, run the code to see the difference between just missing and passing the threshold potential!</p>
<p><em>Part 3</em> Pretty striking difference right? Now imagine there is a neuron where the resting potential is -60 mV rather than -65. What would happen if all else remained equal? Change the resting potential to -60 mV and rerun the code to find out!(Note: HHmodel_compare() also accepts an input for the resting potential.)</p>
<p><strong>Problem 3: Pick your Poison(s)</strong>
<em>Part 1</em> The poisonous dart frog of Central and South America secretes the neurotoxin batrachotoxin (BTX). Exposure to BTX results causes paralysis by irreversibly binding to the sodium channels and preventing them from closing. In the following code, simulate a neuron’s exposure to BTX by setting the relevant variable to the appropriate value. Note: the only code that should be altered has been sectioned off using hashtags.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="Ch4.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define input parameters</span></span>
<span id="cb5-2"><a href="Ch4.html#cb5-2" aria-hidden="true" tabindex="-1"></a>c           <span class="op">=</span>  <span class="dv">10</span> </span>
<span id="cb5-3"><a href="Ch4.html#cb5-3" aria-hidden="true" tabindex="-1"></a>gMaxL       <span class="op">=</span>  <span class="fl">0.003e03</span> </span>
<span id="cb5-4"><a href="Ch4.html#cb5-4" aria-hidden="true" tabindex="-1"></a>EL          <span class="op">=</span>  <span class="op">-</span><span class="fl">54.387</span> </span>
<span id="cb5-5"><a href="Ch4.html#cb5-5" aria-hidden="true" tabindex="-1"></a>gMaxK       <span class="op">=</span>  <span class="fl">0.36e03</span> </span>
<span id="cb5-6"><a href="Ch4.html#cb5-6" aria-hidden="true" tabindex="-1"></a>EK          <span class="op">=</span>  <span class="op">-</span><span class="dv">77</span> </span>
<span id="cb5-7"><a href="Ch4.html#cb5-7" aria-hidden="true" tabindex="-1"></a>gMaxNa      <span class="op">=</span>  <span class="fl">1.2e03</span> </span>
<span id="cb5-8"><a href="Ch4.html#cb5-8" aria-hidden="true" tabindex="-1"></a>ENa         <span class="op">=</span>  <span class="dv">50</span> </span>
<span id="cb5-9"><a href="Ch4.html#cb5-9" aria-hidden="true" tabindex="-1"></a>Ie <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb5-10"><a href="Ch4.html#cb5-10" aria-hidden="true" tabindex="-1"></a>tFinal <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb5-11"><a href="Ch4.html#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="Ch4.html#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up data structures</span></span>
<span id="cb5-13"><a href="Ch4.html#cb5-13" aria-hidden="true" tabindex="-1"></a>timeVec <span class="op">=</span> np.arange(<span class="dv">0</span>,tFinal, dt)</span>
<span id="cb5-14"><a href="Ch4.html#cb5-14" aria-hidden="true" tabindex="-1"></a>voltageVector <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb5-15"><a href="Ch4.html#cb5-15" aria-hidden="true" tabindex="-1"></a>Ivector <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb5-16"><a href="Ch4.html#cb5-16" aria-hidden="true" tabindex="-1"></a>mVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb5-17"><a href="Ch4.html#cb5-17" aria-hidden="true" tabindex="-1"></a>hVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb5-18"><a href="Ch4.html#cb5-18" aria-hidden="true" tabindex="-1"></a>nVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb5-19"><a href="Ch4.html#cb5-19" aria-hidden="true" tabindex="-1"></a>tauVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb5-20"><a href="Ch4.html#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="Ch4.html#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize starting values</span></span>
<span id="cb5-22"><a href="Ch4.html#cb5-22" aria-hidden="true" tabindex="-1"></a>voltageVector[<span class="dv">0</span>] <span class="op">=</span>  <span class="op">-</span><span class="dv">65</span> </span>
<span id="cb5-23"><a href="Ch4.html#cb5-23" aria-hidden="true" tabindex="-1"></a>mVec[<span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.0529</span></span>
<span id="cb5-24"><a href="Ch4.html#cb5-24" aria-hidden="true" tabindex="-1"></a>hVec[<span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.5961</span></span>
<span id="cb5-25"><a href="Ch4.html#cb5-25" aria-hidden="true" tabindex="-1"></a>nVec[<span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.3177</span></span>
<span id="cb5-26"><a href="Ch4.html#cb5-26" aria-hidden="true" tabindex="-1"></a>Ivector[<span class="dv">1999</span>:<span class="dv">7999</span>] <span class="op">=</span> Ie</span>
<span id="cb5-27"><a href="Ch4.html#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="Ch4.html#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop to calculate next values</span></span>
<span id="cb5-29"><a href="Ch4.html#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> v <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(timeVec)<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb5-30"><a href="Ch4.html#cb5-30" aria-hidden="true" tabindex="-1"></a>    alpha_n <span class="op">=</span> <span class="fl">0.01</span><span class="op">*</span>(voltageVector[v] <span class="op">+</span> <span class="dv">55</span>) <span class="op">/</span> </span>
<span id="cb5-31"><a href="Ch4.html#cb5-31" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span><span class="op">-</span>np.exp(<span class="op">-</span><span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">55</span>)))</span>
<span id="cb5-32"><a href="Ch4.html#cb5-32" aria-hidden="true" tabindex="-1"></a>    alpha_m <span class="op">=</span> (<span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">40</span>))<span class="op">/</span></span>
<span id="cb5-33"><a href="Ch4.html#cb5-33" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span><span class="op">-</span>np.exp(<span class="op">-</span><span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">40</span>)))</span>
<span id="cb5-34"><a href="Ch4.html#cb5-34" aria-hidden="true" tabindex="-1"></a>    alpha_h <span class="op">=</span> <span class="fl">0.07</span><span class="op">*</span>np.exp(<span class="op">-</span><span class="fl">.05</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">65</span>))</span>
<span id="cb5-35"><a href="Ch4.html#cb5-35" aria-hidden="true" tabindex="-1"></a>    beta_n <span class="op">=</span> <span class="fl">0.125</span><span class="op">*</span>np.exp(<span class="op">-</span><span class="fl">.01125</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">55</span>))</span>
<span id="cb5-36"><a href="Ch4.html#cb5-36" aria-hidden="true" tabindex="-1"></a>    beta_m <span class="op">=</span> <span class="dv">4</span><span class="op">*</span>np.exp(<span class="op">-</span><span class="fl">.05556</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">65</span>))</span>
<span id="cb5-37"><a href="Ch4.html#cb5-37" aria-hidden="true" tabindex="-1"></a>    beta_h <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span><span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">35</span>)))</span>
<span id="cb5-38"><a href="Ch4.html#cb5-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-39"><a href="Ch4.html#cb5-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-40"><a href="Ch4.html#cb5-40" aria-hidden="true" tabindex="-1"></a>    <span class="co">#############</span></span>
<span id="cb5-41"><a href="Ch4.html#cb5-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if timeVec[v] &gt;= 300:</span></span>
<span id="cb5-42"><a href="Ch4.html#cb5-42" aria-hidden="true" tabindex="-1"></a>         <span class="co">#  =    # Part one</span></span>
<span id="cb5-43"><a href="Ch4.html#cb5-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if timeVec[v] &gt; 600:</span></span>
<span id="cb5-44"><a href="Ch4.html#cb5-44" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   =    # Part two</span></span>
<span id="cb5-45"><a href="Ch4.html#cb5-45" aria-hidden="true" tabindex="-1"></a>    <span class="co">##############</span></span>
<span id="cb5-46"><a href="Ch4.html#cb5-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-47"><a href="Ch4.html#cb5-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update time constants</span></span>
<span id="cb5-48"><a href="Ch4.html#cb5-48" aria-hidden="true" tabindex="-1"></a>    tau_n <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (alpha_n <span class="op">+</span> beta_n)</span>
<span id="cb5-49"><a href="Ch4.html#cb5-49" aria-hidden="true" tabindex="-1"></a>    tau_m <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (alpha_m <span class="op">+</span> beta_m)</span>
<span id="cb5-50"><a href="Ch4.html#cb5-50" aria-hidden="true" tabindex="-1"></a>    tau_h <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (alpha_h <span class="op">+</span> beta_h)</span>
<span id="cb5-51"><a href="Ch4.html#cb5-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-52"><a href="Ch4.html#cb5-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update gating variables</span></span>
<span id="cb5-53"><a href="Ch4.html#cb5-53" aria-hidden="true" tabindex="-1"></a>    pm <span class="op">=</span> alpha_m<span class="op">/</span>(alpha_m <span class="op">+</span> beta_m)</span>
<span id="cb5-54"><a href="Ch4.html#cb5-54" aria-hidden="true" tabindex="-1"></a>    pn <span class="op">=</span> alpha_n<span class="op">/</span>(alpha_n<span class="op">+</span> beta_n)</span>
<span id="cb5-55"><a href="Ch4.html#cb5-55" aria-hidden="true" tabindex="-1"></a>    ph <span class="op">=</span> alpha_h<span class="op">/</span>(alpha_h <span class="op">+</span> beta_h)</span>
<span id="cb5-56"><a href="Ch4.html#cb5-56" aria-hidden="true" tabindex="-1"></a>    mVec[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> pm <span class="op">+</span> (mVec[v] <span class="op">-</span> pm)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tau_m)</span>
<span id="cb5-57"><a href="Ch4.html#cb5-57" aria-hidden="true" tabindex="-1"></a>    nVec[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> pn <span class="op">+</span> (nVec[v] <span class="op">-</span> pn)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tau_n)</span>
<span id="cb5-58"><a href="Ch4.html#cb5-58" aria-hidden="true" tabindex="-1"></a>    hVec[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> ph <span class="op">+</span> (hVec[v] <span class="op">-</span> ph)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tau_h)</span>
<span id="cb5-59"><a href="Ch4.html#cb5-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-60"><a href="Ch4.html#cb5-60" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update voltage</span></span>
<span id="cb5-61"><a href="Ch4.html#cb5-61" aria-hidden="true" tabindex="-1"></a>    denominator <span class="op">=</span> gMaxL <span class="op">+</span> gMaxK<span class="op">*</span>(nVec[v]<span class="op">**</span><span class="dv">4</span>) <span class="op">+</span> gMaxNa<span class="op">*</span>(mVec[v]<span class="op">**</span><span class="dv">3</span>)<span class="op">*</span>hVec[v]</span>
<span id="cb5-62"><a href="Ch4.html#cb5-62" aria-hidden="true" tabindex="-1"></a>    tauV <span class="op">=</span> c <span class="op">/</span> denominator</span>
<span id="cb5-63"><a href="Ch4.html#cb5-63" aria-hidden="true" tabindex="-1"></a>    Vinf <span class="op">=</span> ((gMaxL)<span class="op">*</span>EL <span class="op">+</span> gMaxK<span class="op">*</span>(nVec[v]<span class="op">**</span><span class="dv">4</span>)<span class="op">*</span>EK <span class="op">+</span> </span>
<span id="cb5-64"><a href="Ch4.html#cb5-64" aria-hidden="true" tabindex="-1"></a>      gMaxNa<span class="op">*</span>(mVec[v]<span class="op">**</span><span class="dv">3</span>)<span class="op">*</span>hVec[v]<span class="op">*</span>ENa <span class="op">+</span> Ivector[v])<span class="op">/</span> denominator   </span>
<span id="cb5-65"><a href="Ch4.html#cb5-65" aria-hidden="true" tabindex="-1"></a>    voltageVector[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> Vinf <span class="op">+</span> </span>
<span id="cb5-66"><a href="Ch4.html#cb5-66" aria-hidden="true" tabindex="-1"></a>      (voltageVector[v]<span class="op">-</span>Vinf)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tauV) </span>
<span id="cb5-67"><a href="Ch4.html#cb5-67" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-68"><a href="Ch4.html#cb5-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb5-69"><a href="Ch4.html#cb5-69" aria-hidden="true" tabindex="-1"></a>plt.figure(<span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">10</span>))</span>
<span id="cb5-70"><a href="Ch4.html#cb5-70" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb5-71"><a href="Ch4.html#cb5-71" aria-hidden="true" tabindex="-1"></a>plt.plot(timeVec,voltageVector)</span>
<span id="cb5-72"><a href="Ch4.html#cb5-72" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Hodgkin and Huxley Simulation&#39;</span>)</span>
<span id="cb5-73"><a href="Ch4.html#cb5-73" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Voltage in mV&#39;</span>)</span>
<span id="cb5-74"><a href="Ch4.html#cb5-74" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb5-75"><a href="Ch4.html#cb5-75" aria-hidden="true" tabindex="-1"></a>plt.plot(timeVec, mVec)</span>
<span id="cb5-76"><a href="Ch4.html#cb5-76" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;g_Na activation variable m&#39;</span>)</span>
<span id="cb5-77"><a href="Ch4.html#cb5-77" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb5-78"><a href="Ch4.html#cb5-78" aria-hidden="true" tabindex="-1"></a>plt.plot(timeVec, hVec)</span>
<span id="cb5-79"><a href="Ch4.html#cb5-79" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;g_Na inactivation variable h&#39;</span>)</span>
<span id="cb5-80"><a href="Ch4.html#cb5-80" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">4</span>)</span>
<span id="cb5-81"><a href="Ch4.html#cb5-81" aria-hidden="true" tabindex="-1"></a>plt.plot(timeVec, nVec)</span>
<span id="cb5-82"><a href="Ch4.html#cb5-82" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;g_K activation variable&#39;</span>)</span></code></pre></div>
<p><em>Part 2</em> Unfortunately, there is no effective treatment to BTX poisoning. However, in theory, the membrane depolarization can be reversed using tetrodotoxin (TTX), which is produced by the pufferfish, blue ringed octopus, and other deadly creatures. This toxin also causes paralysis. However, unlike BTX, TTX prevents action potentials by binding to voltage-gated sodium channels and preventing the movement of sodium ions into the cell. Revise the above code to simulate exposure to TTX 300 ms after the BTX poisoning.</p>
<p><em>Part 3</em> Observe the behavior of the neuron between 600 and 800 ms. While this looks like more ideal behavior than when the neuron was exposed to only BTX, what should the behavior of the neuron be if neither poison had been administered? (Note, while this is a conceptual question, feel free to alter the code to see what should occur).</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Ch3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Ch5.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-HodgkinHuxley.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Computational Neuroscience.pdf", "Computational Neuroscience.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
