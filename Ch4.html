<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Hodgkin and Huxley Model | Computational Neuroscience</title>
  <meta name="description" content="TBD" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Hodgkin and Huxley Model | Computational Neuroscience" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.png" />
  <meta property="og:description" content="TBD" />
  <meta name="github-repo" content="mrgreene09/compNeuroTextbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Hodgkin and Huxley Model | Computational Neuroscience" />
  
  <meta name="twitter:description" content="TBD" />
  <meta name="twitter:image" content="images/cover.png" />

<meta name="author" content="Students of NS/PY 357 Bates College" />


<meta name="date" content="2020-10-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Ch3.html"/>
<link rel="next" href="Ch5.html"/>
<script src="assets/jquery-2.2.3/jquery.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="assets/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#this-book-is-free-as-in-pizza"><i class="fa fa-check"></i><b>1.1</b> This book is free (as in pizza)</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#this-book-is-free-as-in-speech"><i class="fa fa-check"></i><b>1.2</b> This book is free (as in speech)</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#this-book-can-be-revised-and-disseminated-more-rapidly-than-traditional-textbooks"><i class="fa fa-check"></i><b>1.3</b> This book can be revised and disseminated more rapidly than traditional textbooks</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#this-book-creates-a-public-record-of-learning-that-exists-after-the-semester-ends"><i class="fa fa-check"></i><b>1.4</b> This book creates a public record of learning that exists after the semester ends</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#authors-version-0.0"><i class="fa fa-check"></i><b>1.5</b> Authors: Version 0.0</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#authors-version-1.0"><i class="fa fa-check"></i><b>1.6</b> Authors: Version 1.0</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Ch1.html"><a href="Ch1.html"><i class="fa fa-check"></i><b>2</b> Introduction to Python</a><ul>
<li class="chapter" data-level="2.1" data-path="Ch1.html"><a href="Ch1.html#vocabulary"><i class="fa fa-check"></i><b>2.1</b> Vocabulary</a></li>
<li class="chapter" data-level="2.2" data-path="Ch1.html"><a href="Ch1.html#introduction"><i class="fa fa-check"></i><b>2.2</b> Introduction</a></li>
<li class="chapter" data-level="2.3" data-path="Ch1.html"><a href="Ch1.html#summary"><i class="fa fa-check"></i><b>2.3</b> Summary</a></li>
<li class="chapter" data-level="2.4" data-path="Ch1.html"><a href="Ch1.html#example-python-problems"><i class="fa fa-check"></i><b>2.4</b> Example Python Problems</a></li>
<li class="chapter" data-level="2.5" data-path="Ch1.html"><a href="Ch1.html#conceptual-exercises-for-learning-python"><i class="fa fa-check"></i><b>2.5</b> Conceptual Exercises for Learning Python</a></li>
<li class="chapter" data-level="2.6" data-path="Ch1.html"><a href="Ch1.html#coding-exercises-for-learning-python"><i class="fa fa-check"></i><b>2.6</b> Coding Exercises for Learning Python</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Ch2.html"><a href="Ch2.html"><i class="fa fa-check"></i><b>3</b> What is Computational Neuroscience?</a><ul>
<li class="chapter" data-level="3.1" data-path="Ch1.html"><a href="Ch1.html#vocabulary"><i class="fa fa-check"></i><b>3.1</b> Vocabulary</a></li>
<li class="chapter" data-level="3.2" data-path="Ch1.html"><a href="Ch1.html#introduction"><i class="fa fa-check"></i><b>3.2</b> Introduction</a></li>
<li class="chapter" data-level="3.3" data-path="Ch2.html"><a href="Ch2.html#what-is-computational-neuroscience"><i class="fa fa-check"></i><b>3.3</b> What is computational neuroscience?</a></li>
<li class="chapter" data-level="3.4" data-path="Ch2.html"><a href="Ch2.html#levels-of-organization"><i class="fa fa-check"></i><b>3.4</b> Levels of organization</a></li>
<li class="chapter" data-level="3.5" data-path="Ch2.html"><a href="Ch2.html#applications-of-computational-neuroscience"><i class="fa fa-check"></i><b>3.5</b> Applications of computational neuroscience</a></li>
<li class="chapter" data-level="3.6" data-path="Ch2.html"><a href="Ch2.html#the-future-of-computational-neuroscience"><i class="fa fa-check"></i><b>3.6</b> The future of computational neuroscience</a></li>
<li class="chapter" data-level="3.7" data-path="Ch1.html"><a href="Ch1.html#summary"><i class="fa fa-check"></i><b>3.7</b> Summary</a></li>
<li class="chapter" data-level="3.8" data-path="Ch2.html"><a href="Ch2.html#exercises"><i class="fa fa-check"></i><b>3.8</b> Exercises:</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Ch3.html"><a href="Ch3.html"><i class="fa fa-check"></i><b>4</b> Passive Membrane Models</a><ul>
<li class="chapter" data-level="4.1" data-path="Ch1.html"><a href="Ch1.html#vocabulary"><i class="fa fa-check"></i><b>4.1</b> Vocabulary</a></li>
<li class="chapter" data-level="4.2" data-path="Ch1.html"><a href="Ch1.html#introduction"><i class="fa fa-check"></i><b>4.2</b> Introduction</a></li>
<li class="chapter" data-level="4.3" data-path="Ch3.html"><a href="Ch3.html#what-is-an-action-potential"><i class="fa fa-check"></i><b>4.3</b> What is an action potential?</a></li>
<li class="chapter" data-level="4.4" data-path="Ch3.html"><a href="Ch3.html#nernst-equilibrium-potential"><i class="fa fa-check"></i><b>4.4</b> Nernst equilibrium potential</a></li>
<li class="chapter" data-level="4.5" data-path="Ch3.html"><a href="Ch3.html#leaky-integrate-and-fire-model"><i class="fa fa-check"></i><b>4.5</b> Leaky Integrate and Fire Model</a></li>
<li class="chapter" data-level="4.6" data-path="Ch1.html"><a href="Ch1.html#summary"><i class="fa fa-check"></i><b>4.6</b> Summary</a></li>
<li class="chapter" data-level="4.7" data-path="Ch2.html"><a href="Ch2.html#exercises"><i class="fa fa-check"></i><b>4.7</b> Exercises</a><ul>
<li class="chapter" data-level="4.7.1" data-path="Ch3.html"><a href="Ch3.html#conceptual-exercises"><i class="fa fa-check"></i><b>4.7.1</b> Conceptual Exercises</a></li>
<li class="chapter" data-level="4.7.2" data-path="Ch3.html"><a href="Ch3.html#coding-exercises"><i class="fa fa-check"></i><b>4.7.2</b> Coding Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Ch4.html"><a href="Ch4.html"><i class="fa fa-check"></i><b>5</b> Hodgkin and Huxley Model</a><ul>
<li class="chapter" data-level="5.1" data-path="Ch1.html"><a href="Ch1.html#vocabulary"><i class="fa fa-check"></i><b>5.1</b> Vocabulary</a></li>
<li class="chapter" data-level="5.2" data-path="Ch1.html"><a href="Ch1.html#introduction"><i class="fa fa-check"></i><b>5.2</b> Introduction</a></li>
<li class="chapter" data-level="5.3" data-path="Ch4.html"><a href="Ch4.html#the-hodgkin-and-huxley-model"><i class="fa fa-check"></i><b>5.3</b> The Hodgkin and Huxley model</a></li>
<li class="chapter" data-level="5.4" data-path="Ch1.html"><a href="Ch1.html#summary"><i class="fa fa-check"></i><b>5.4</b> Summary</a></li>
<li class="chapter" data-level="5.5" data-path="Ch2.html"><a href="Ch2.html#exercises"><i class="fa fa-check"></i><b>5.5</b> Exercises:</a><ul>
<li class="chapter" data-level="5.5.1" data-path="Ch3.html"><a href="Ch3.html#conceptual-exercises"><i class="fa fa-check"></i><b>5.5.1</b> Conceptual Exercises:</a></li>
<li class="chapter" data-level="5.5.2" data-path="Ch3.html"><a href="Ch3.html#coding-exercises"><i class="fa fa-check"></i><b>5.5.2</b> Coding Exercises:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Ch5.html"><a href="Ch5.html"><i class="fa fa-check"></i><b>6</b> Firing Rates</a><ul>
<li class="chapter" data-level="6.1" data-path="Ch1.html"><a href="Ch1.html#vocabulary"><i class="fa fa-check"></i><b>6.1</b> Vocabulary</a></li>
<li class="chapter" data-level="6.2" data-path="Ch1.html"><a href="Ch1.html#introduction"><i class="fa fa-check"></i><b>6.2</b> Introduction</a></li>
<li class="chapter" data-level="6.3" data-path="Ch5.html"><a href="Ch5.html#spike-trains"><i class="fa fa-check"></i><b>6.3</b> Spike Trains</a></li>
<li class="chapter" data-level="6.4" data-path="Ch5.html"><a href="Ch5.html#spike-statistics"><i class="fa fa-check"></i><b>6.4</b> Spike Statistics</a></li>
<li class="chapter" data-level="6.5" data-path="Ch1.html"><a href="Ch1.html#summary"><i class="fa fa-check"></i><b>6.5</b> Summary</a></li>
<li class="chapter" data-level="6.6" data-path="Ch2.html"><a href="Ch2.html#exercises"><i class="fa fa-check"></i><b>6.6</b> Exercises</a><ul>
<li class="chapter" data-level="6.6.1" data-path="Ch5.html"><a href="Ch5.html#conceptual-problems"><i class="fa fa-check"></i><b>6.6.1</b> Conceptual Problems</a></li>
<li class="chapter" data-level="6.6.2" data-path="Ch5.html"><a href="Ch5.html#coding-problems"><i class="fa fa-check"></i><b>6.6.2</b> Coding Problems</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Ch6.html"><a href="Ch6.html"><i class="fa fa-check"></i><b>7</b> Reverse Correlation and Receptive Field Mapping</a><ul>
<li class="chapter" data-level="7.1" data-path="Ch1.html"><a href="Ch1.html#vocabulary"><i class="fa fa-check"></i><b>7.1</b> Vocabulary</a></li>
<li class="chapter" data-level="7.2" data-path="Ch1.html"><a href="Ch1.html#introduction"><i class="fa fa-check"></i><b>7.2</b> Introduction</a></li>
<li class="chapter" data-level="7.3" data-path="Ch6.html"><a href="Ch6.html#spike-triggered-average"><i class="fa fa-check"></i><b>7.3</b> Spike-triggered Average</a></li>
<li class="chapter" data-level="7.4" data-path="Ch6.html"><a href="Ch6.html#reverse-correlation"><i class="fa fa-check"></i><b>7.4</b> Reverse Correlation</a></li>
<li class="chapter" data-level="7.5" data-path="Ch1.html"><a href="Ch1.html#summary"><i class="fa fa-check"></i><b>7.5</b> Summary</a></li>
<li class="chapter" data-level="7.6" data-path="Ch2.html"><a href="Ch2.html#exercises"><i class="fa fa-check"></i><b>7.6</b> Exercises</a><ul>
<li class="chapter" data-level="7.6.1" data-path="Ch3.html"><a href="Ch3.html#conceptual-exercises"><i class="fa fa-check"></i><b>7.6.1</b> Conceptual Exercises</a></li>
<li class="chapter" data-level="7.6.2" data-path="Ch3.html"><a href="Ch3.html#coding-exercises"><i class="fa fa-check"></i><b>7.6.2</b> Coding Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Ch7.html"><a href="Ch7.html"><i class="fa fa-check"></i><b>8</b> Decoding</a><ul>
<li class="chapter" data-level="8.1" data-path="Ch1.html"><a href="Ch1.html#vocabulary"><i class="fa fa-check"></i><b>8.1</b> Vocabulary</a></li>
<li class="chapter" data-level="8.2" data-path="Ch1.html"><a href="Ch1.html#introduction"><i class="fa fa-check"></i><b>8.2</b> Introduction</a></li>
<li class="chapter" data-level="8.3" data-path="Ch7.html"><a href="Ch7.html#imaging-techniques"><i class="fa fa-check"></i><b>8.3</b> Imaging Techniques</a><ul>
<li class="chapter" data-level="8.3.1" data-path="Ch7.html"><a href="Ch7.html#eeg"><i class="fa fa-check"></i><b>8.3.1</b> EEG</a></li>
<li class="chapter" data-level="8.3.2" data-path="Ch7.html"><a href="Ch7.html#meg"><i class="fa fa-check"></i><b>8.3.2</b> MEG</a></li>
<li class="chapter" data-level="8.3.3" data-path="Ch7.html"><a href="Ch7.html#fmri"><i class="fa fa-check"></i><b>8.3.3</b> fMRI</a></li>
<li class="chapter" data-level="8.3.4" data-path="Ch7.html"><a href="Ch7.html#ecog"><i class="fa fa-check"></i><b>8.3.4</b> ECOG</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="Ch7.html"><a href="Ch7.html#introduction-to-decoding"><i class="fa fa-check"></i><b>8.4</b> Introduction to Decoding</a></li>
<li class="chapter" data-level="8.5" data-path="Ch7.html"><a href="Ch7.html#what-is-a-classifier"><i class="fa fa-check"></i><b>8.5</b> What is a classifier?</a><ul>
<li class="chapter" data-level="8.5.1" data-path="Ch7.html"><a href="Ch7.html#correlation-classifiers"><i class="fa fa-check"></i><b>8.5.1</b> Correlation classifiers</a></li>
<li class="chapter" data-level="8.5.2" data-path="Ch7.html"><a href="Ch7.html#distance-based-classifiers"><i class="fa fa-check"></i><b>8.5.2</b> Distance-based classifiers</a></li>
<li class="chapter" data-level="8.5.3" data-path="Ch7.html"><a href="Ch7.html#boundary-based-classifiers"><i class="fa fa-check"></i><b>8.5.3</b> Boundary-based classifiers</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="Ch7.html"><a href="Ch7.html#cross-validation"><i class="fa fa-check"></i><b>8.6</b> Cross validation</a></li>
<li class="chapter" data-level="8.7" data-path="Ch7.html"><a href="Ch7.html#conclusion"><i class="fa fa-check"></i><b>8.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Ch8.html"><a href="Ch8.html"><i class="fa fa-check"></i><b>9</b> Neural Networks</a><ul>
<li class="chapter" data-level="9.1" data-path="Ch8.html"><a href="Ch8.html#vocabulary-list"><i class="fa fa-check"></i><b>9.1</b> Vocabulary List:</a></li>
<li class="chapter" data-level="9.2" data-path="Ch8.html"><a href="Ch8.html#introductionbackground"><i class="fa fa-check"></i><b>9.2</b> Introduction/Background</a></li>
<li class="chapter" data-level="9.3" data-path="Ch8.html"><a href="Ch8.html#different-types-of-learning"><i class="fa fa-check"></i><b>9.3</b> Different Types of Learning</a></li>
<li class="chapter" data-level="9.4" data-path="Ch8.html"><a href="Ch8.html#mcculloch-pitt-mcp-neurons"><i class="fa fa-check"></i><b>9.4</b> McCulloch-Pitt (MCP) Neurons</a></li>
<li class="chapter" data-level="9.5" data-path="Ch8.html"><a href="Ch8.html#perceptron"><i class="fa fa-check"></i><b>9.5</b> Perceptron</a></li>
<li class="chapter" data-level="9.6" data-path="Ch1.html"><a href="Ch1.html#summary"><i class="fa fa-check"></i><b>9.6</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Ch9.html"><a href="Ch9.html"><i class="fa fa-check"></i><b>10</b> Glossary</a></li>
<li class="chapter" data-level="11" data-path="Ch10.html"><a href="Ch10.html"><i class="fa fa-check"></i><b>11</b> References</a><ul>
<li class="chapter" data-level="11.1" data-path="Ch10.html"><a href="Ch10.html#chapter-1-preface"><i class="fa fa-check"></i><b>11.1</b> Chapter 1: Preface</a></li>
<li class="chapter" data-level="11.2" data-path="Ch10.html"><a href="Ch10.html#chapter-2-introduction-to-python"><i class="fa fa-check"></i><b>11.2</b> Chapter 2: Introduction to Python</a></li>
<li class="chapter" data-level="11.3" data-path="Ch10.html"><a href="Ch10.html#chapter-3-what-is-computational-neuroscience"><i class="fa fa-check"></i><b>11.3</b> Chapter 3: What is Computational Neuroscience?</a></li>
<li class="chapter" data-level="11.4" data-path="Ch10.html"><a href="Ch10.html#chapter-4-passive-membrane-models"><i class="fa fa-check"></i><b>11.4</b> Chapter 4: Passive Membrane Models</a></li>
<li class="chapter" data-level="11.5" data-path="Ch10.html"><a href="Ch10.html#chapter-5-hodgkin-and-huxley"><i class="fa fa-check"></i><b>11.5</b> Chapter 5: Hodgkin and Huxley</a></li>
<li class="chapter" data-level="11.6" data-path="Ch10.html"><a href="Ch10.html#chapter-6-firing-rates"><i class="fa fa-check"></i><b>11.6</b> Chapter 6: Firing Rates</a></li>
<li class="chapter" data-level="11.7" data-path="Ch10.html"><a href="Ch10.html#chapter-7-reverse-correlation-and-receptive-field-mapping"><i class="fa fa-check"></i><b>11.7</b> Chapter 7: Reverse Correlation and Receptive Field Mapping</a></li>
<li class="chapter" data-level="11.8" data-path="Ch10.html"><a href="Ch10.html#chapter-8-decoding"><i class="fa fa-check"></i><b>11.8</b> Chapter 8: Decoding</a></li>
<li class="chapter" data-level="11.9" data-path="Ch10.html"><a href="Ch10.html#chapter-9-neural-networks"><i class="fa fa-check"></i><b>11.9</b> Chapter 9: Neural Networks</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="Ch11.html"><a href="Ch11.html"><i class="fa fa-check"></i><b>12</b> Answers to Exercises</a><ul>
<li class="chapter" data-level="12.1" data-path="Ch11.html"><a href="Ch11.html#chapter-1-introduction-to-python"><i class="fa fa-check"></i><b>12.1</b> Chapter 1: Introduction to Python</a></li>
<li class="chapter" data-level="12.2" data-path="Ch11.html"><a href="Ch11.html#chapter-2-introduction-to-computational-neuroscience"><i class="fa fa-check"></i><b>12.2</b> Chapter 2: Introduction to Computational Neuroscience</a></li>
<li class="chapter" data-level="12.3" data-path="Ch11.html"><a href="Ch11.html#chapter-3-passive-membrane-models"><i class="fa fa-check"></i><b>12.3</b> Chapter 3: Passive Membrane Models</a><ul>
<li class="chapter" data-level="12.3.1" data-path="Ch11.html"><a href="Ch11.html#conceptual-questions"><i class="fa fa-check"></i><b>12.3.1</b> Conceptual Questions</a></li>
<li class="chapter" data-level="12.3.2" data-path="Ch11.html"><a href="Ch11.html#coding-questions"><i class="fa fa-check"></i><b>12.3.2</b> Coding Questions</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="Ch11.html"><a href="Ch11.html#chapter-4-hodgkin-and-huxley"><i class="fa fa-check"></i><b>12.4</b> Chapter 4: Hodgkin and Huxley</a><ul>
<li class="chapter" data-level="12.4.1" data-path="Ch11.html"><a href="Ch11.html#conceptual-questions-1"><i class="fa fa-check"></i><b>12.4.1</b> Conceptual Questions:</a></li>
<li class="chapter" data-level="12.4.2" data-path="Ch11.html"><a href="Ch11.html#coding-questions-1"><i class="fa fa-check"></i><b>12.4.2</b> Coding Questions:</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="Ch11.html"><a href="Ch11.html#chapter-5-firing-rates"><i class="fa fa-check"></i><b>12.5</b> Chapter 5: Firing Rates</a><ul>
<li class="chapter" data-level="12.5.1" data-path="Ch11.html"><a href="Ch11.html#conceptual-questions-2"><i class="fa fa-check"></i><b>12.5.1</b> Conceptual Questions</a></li>
<li class="chapter" data-level="12.5.2" data-path="Ch11.html"><a href="Ch11.html#coding-questions-2"><i class="fa fa-check"></i><b>12.5.2</b> Coding Questions</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="Ch11.html"><a href="Ch11.html#chapter-6-reverse-correlation-and-receptive-field-mapping"><i class="fa fa-check"></i><b>12.6</b> Chapter 6: Reverse Correlation and Receptive Field Mapping</a><ul>
<li class="chapter" data-level="12.6.1" data-path="Ch11.html"><a href="Ch11.html#conceptual-questions-3"><i class="fa fa-check"></i><b>12.6.1</b> Conceptual Questions</a></li>
<li class="chapter" data-level="12.6.2" data-path="Ch11.html"><a href="Ch11.html#coding-questions-3"><i class="fa fa-check"></i><b>12.6.2</b> Coding Questions</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="Ch11.html"><a href="Ch11.html#chapter-7-decoding"><i class="fa fa-check"></i><b>12.7</b> Chapter 7: Decoding</a></li>
<li class="chapter" data-level="12.8" data-path="Ch11.html"><a href="Ch11.html#chapter-8-neural-networks"><i class="fa fa-check"></i><b>12.8</b> Chapter 8: Neural Networks</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Computational Neuroscience</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Ch4" class="section level1">
<h1><span class="header-section-number">5</span> Hodgkin and Huxley Model</h1>
<div id="vocabulary" class="section level2">
<h2><span class="header-section-number">5.1</span> Vocabulary</h2>
<ul>
<li>Depolarization</li>
<li>Positive Feedback</li>
<li>Hyperpolarization</li>
<li>Negative Feedback</li>
<li>Membrane Potential</li>
<li>Sodium-Potassium Pump</li>
<li>Nernst Potential</li>
<li>Reversal Potential</li>
<li>Equilibrium Potential</li>
<li>Driving Force</li>
<li>Conductance</li>
<li>Leak Current</li>
<li>Leaky Integrate and Fire Model</li>
<li>Absolute Refractory Period</li>
<li>Gating variable</li>
</ul>
</div>
<div id="introduction" class="section level2">
<h2><span class="header-section-number">5.2</span> Introduction</h2>
<p>Before you read this chapter, we would like to draw your attention to this <a href="https://www.youtube.com/watch?v=dzj95jHuPiw">video</a>. We call this a Zombie Squid because the squid is in fact dead; however, it is recently deceased. Since the squid passed shortly before, Adenosine triphosphate (ATP) energy stores are still available to the squid’s muscles. When the soy sauce, which has a lot of sodium chloride (salt) in it, is poured onto the squid, the salt in the soy sauce causes a voltage change which causes the squid’s muscles to contract. Thus, we have a Zombie Squid.</p>
<p>So why is the Zombie Squid important? The Hodgkin-Huxley Model, said to have started the field of computational neuroscience, all hinges on the giant axons of squid. In the 1950s Alan Hodgkin and Andrew Huxley built a model that shows us how computers can successfully predict certain aspects of the brain that cannot be directly studied. The two even won a Nobel Prize in Physiology or Medicine in 1963 with Sir John Carew Eccles for their model. The Hodgkin-Huxley Model is now the basis of all conductance-based models. As a result, we can now understand how an action potential works, and why it is an all-or-none event.</p>
<p>While Hodgkin and Huxley created their model in the 1950s, the first recording of an action potential was done by Edgar Adrian in the 1920s. However, the first person to realize that neurons communicate via electrical signals came much earlier in 1791, when Luigi Galvani found that electricity from lightning or primitive batteries can cause a dead frog’s leg muscle to contract. This led to a good amount of Frankenstein-like science with interested parties running electricity through dead bodies in an attempt to bring them back to life. However, the next truly scientific discovery came from Hermann Helmholtz in the 19th century. Helmholtz found that he could measure the speed of muscles contracting when he stimulated the nerve linked to that specific muscle. The Hodgkin-Huxley Model was then created once Adrian noted that not only were action potentials discrete, but the firing rate (spike per second) increased as stimulation to the nerve increased.</p>
</div>
<div id="the-hodgkin-and-huxley-model" class="section level2">
<h2><span class="header-section-number">5.3</span> The Hodgkin and Huxley model</h2>
<div style="float:left;width:564px">
<div class="figure"><span id="fig:hodgkinHuxley-fig"></span>
<img src="images/HodgkinHuxley.png" alt="Alan Hodgkin (left) and Andrew Huxley (right)."  />
<p class="caption">
Figure 5.1: Alan Hodgkin (left) and Andrew Huxley (right).
</p>
</div>
</div>
<p>Alan Hodgkin (pictured left) and Andrew Huxley (pictured right) were two Cambridge University undergraduates who eventually found themselves working in a marine biology laboratory with the axon of a giant squid. The two men were able to derive the necessary information for their influential model of an action potential using the massive axon of the giant squid.</p>
<p>Hodgkin and Huxley developed a series of equations that could accurately predict and depict action potentials. Their work is a cornerstone for computational modeling as computer modelling can now be used to mimic the biological properties of a neuron that we are unable to directly observe.</p>
<p>Really the Hodgkin-Huxley Model is just an elaboration on the Integrate and Fire Model. The Integrate and Fire model was generated by French neuroscientist Louis Lapicque, who in 1907 sought to generate a mathematical model that could be used to predict and graph an action potential. In his efforts to understand action potentials, Lapicque chose to model the flow of ions as a single <strong>leak current</strong>.</p>
<p>Hodgkin and Huxley took the single conductance term from the Integrate and Fire Model is broken up into three separate conductance terms, each relating to a different ion channel. These conductance terms are known as <strong>gating variables</strong> and are labeled <em>m</em>, <em>n</em>, and <em>h</em>. Voltage-gated sodium channel activation is modeled by the letter <em>ms</em>. Voltage-gated sodium channels have three subunits, as these three subunits are involved in the channels activation, <em>m</em> is raised to the third power. Voltage-gated sodium channel also inactivate at the peak of the action potential and this variable is modeled by the letter <em>h</em>. The combination of <em>m</em> and <em>h</em> gives rise to the conductance of Voltage-gated sodium channel which is modeled below: <span class="math display">\[\bar{g}_{Na}m^{3}h(V(t)-E_{Na}) \]</span>
Voltage-gated potassium channels are modeled by the letter <em>n</em>. Voltage-gated potassium channels have four subunits, and thus the gating variable, <em>n</em>, is raised to the fourth power. The conductance of Voltage-gated potassium channels is modeled below: <span class="math display">\[\bar{g}_{K}n^{4}(V(t)-E_{K} \]</span>
The final conductance taken into account by Hodgkin and Huxley is the leak potential of all the ions. The Leak conductance is taken into account for the instance when all ion channels are open. This conductance is represented below: <span class="math display">\[\bar{g}_{L}(V(t)-E_{L}) \]</span>
These three conductance variables are combined together to form the Hodgkin-Huxley equation which is written as follows: <span class="math display">\[C\frac{dV}{dt}=I_{e}(t)-[(\bar{g}_{Na}m^{3}h(V(t)-E_{Na}))+(\bar{g}_{K}n^{4}(V(t)-E_{K}))+(\bar{g}_{L}(V(t)-E_{L}))] \]</span></p>
<table>
<thead>
<tr class="header">
<th>Expression</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>n</em></td>
<td>Potassium gating variable</td>
</tr>
<tr class="even">
<td><em>m</em></td>
<td>Sodium activation gating variable</td>
</tr>
<tr class="odd">
<td><em>h</em></td>
<td>Sodium inactivation gating variable</td>
</tr>
<tr class="even">
<td><span class="math inline">\(C_m\)</span></td>
<td>Specific membrane capacitance</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(I_e\)</span></td>
<td>Injected current</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\bar{g}_{Na}\)</span></td>
<td>Maximum Na+ conductance</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\bar{g}_{K}\)</span></td>
<td>Maximum K+ conductance</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\bar{g}_{L}\)</span></td>
<td>Maximum leak conductance</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(V_m\)</span></td>
<td>Membrane potential</td>
</tr>
<tr class="even">
<td><span class="math inline">\(E_{Na}\)</span></td>
<td>Sodium Nernst potential</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(E_{K}\)</span></td>
<td>Potassium Nernst potential</td>
</tr>
<tr class="even">
<td><span class="math inline">\(E_{L}\)</span></td>
<td>Leak Nernst potential</td>
</tr>
</tbody>
</table>
<p>Additionally, we can calculate the value of each gating variable over different voltages and times: <span class="math display">\[m\frac{dV}{dt} = \alpha_{m}(V)(1-m)-\beta_{m}(V)m \]</span>
Both <em>n</em> and <em>h</em> can be substituted for <em>m</em> in the above equation in order to calculate values for each gating variable. Additionally, note the <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> in the equation are rate constants that govern the opening and closing (respectively), of their channels. Here are their values:<br />
<span class="math display">\[ \alpha_{n}(V_{m}) = \frac{0.01(V_{m}+55)}{1-exp(-0.1(V_{m}+55))} \]</span>
<span class="math display">\[\alpha_{m}(V_{m}) = \frac{0.1(V_{m}+40)}{1-exp(-0.1(V_{m}+40))}\]</span>
<span class="math display">\[\alpha_{h}(V_{m}) = 0.07exp(-0.05(V_{m}+65)) \]</span>
<span class="math display">\[\beta_{n}(V_m) = 0.125exp(-0.0125(V_{m}+65)) \]</span>
<span class="math display">\[\beta_{m}(V_{m}) = 4exp(-0.0556(V_{m}+65)) \]</span>
<span class="math display">\[\beta_{h}(V_{m}) = \frac{1}{1+exp(-0.1(V_{m}+35))} \]</span></p>
<table>
<thead>
<tr class="header">
<th>Expression</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\alpha_n\)</span></td>
<td>Rate constant for K+ channel opening</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\alpha_m\)</span></td>
<td>Rate constant for Na+ activation gate opening</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\alpha_h\)</span></td>
<td>Rate constant for Na+ inactivation gate opening</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta_n\)</span></td>
<td>Rate constant for K+ channel closing</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\beta_m\)</span></td>
<td>Rate constant for Na+ activation gate closing</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta_h\)</span></td>
<td>Rate constant for Na+ inactivation gate closing</td>
</tr>
</tbody>
</table>
<p><strong>Worked Example:</strong><br />
Have you ever wondered how anesthesia makes a tooth extraction painless? It’s because anesthesia works by blocking the activation of voltage-dependent Na+ channels. This prevents the propagation of the action potentials that carry that awful pain sensation.</p>
<p>Using the equations below, calculate the maximum conductances of each ion in the resting state.</p>
<p>Useful parameters:</p>
<ul>
<li><span class="math inline">\(V_m\)</span> = -68 mV</li>
<li><span class="math inline">\(C_m\)</span> = -20.1 nF</li>
<li><span class="math inline">\(E_L\)</span> = -54 mV</li>
<li><span class="math inline">\(E_{Na}\)</span> = 50 mV</li>
<li><span class="math inline">\(E_K\)</span> = -77 mV</li>
<li><span class="math inline">\(R_L = 1/3 M\Omega\)</span></li>
<li><span class="math inline">\(g_{Na} = 1200 mS/mm^2\)</span></li>
</ul>
<p>Equations:<br />
<span class="math display">\[I_{ion} = g_{Na} \cdot m^3h(V_m-E_{Na}) + g_K \cdot n^4 (V_m-E_K) + g_L \cdot (V_m-E_L)\]</span>
<span class="math display">\[\frac{dn}{dt} = \alpha_n(V) \cdot (1-n) - \beta_n(V) \cdot(n)\]</span>
<span class="math display">\[\frac{dm}{dt} = \alpha_m(V) \cdot (1-m) - \beta_m(V) \cdot(m)\]</span>
<span class="math display">\[\frac{dh}{dt} = \alpha_h(V) \cdot (1-h) - \beta_h(V) \cdot(h)\]</span></p>
<p><em>Step 1: Understand the question</em> The resting potential can be considered to be a steady state because the voltage is not changing. Therefore, <span class="math inline">\(\frac{dp}{dt}=0\)</span> for p={n, m, h} and therefore the last three equations will not be used.</p>
<p><em>Step 2: Calculate n, m, and h</em> We need to now use the resting potential to solve for the steady state values of the gating variables.<br />
<span class="math display">\[p_\infty = \frac{\alpha_p}{\alpha_p+\beta_p}\]</span>
for p = {n, m, h}</p>
<p>Therefore, the very first step is to calculate each <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>.</p>
<p><span class="math display">\[ \alpha_{n}(V_{m}) = \frac{0.01(V_{m}+55)}{1-exp(-0.1(V_{m}+55))} \]</span>
<span class="math display">\[\alpha_{n}(V_{rest}) = \frac{0.01(-68+55)}{1-exp(-0.1(-68+55))} \]</span>
<span class="math display">\[\alpha_{n} = 0.049\]</span></p>
<p><span class="math display">\[\alpha_{m}(V_{m}) = \frac{0.1(V_{m}+40)}{1-exp(-0.1(V_{m}+40))}\]</span>
<span class="math display">\[\alpha_{m}(V_{rest}) = \frac{0.1(-68+40)}{1-exp(-0.1(-68+40))}\]</span>
<span class="math display">\[\alpha_{m}(V_{rest}) = 0.18\]</span></p>
<p><span class="math display">\[\alpha_{h}(V_{m}) = 0.07exp(-0.05(V_{m}+65)) \]</span>
<span class="math display">\[\alpha_{h}(V_{rest}) = 0.07 \cdot exp(-0.05 \cdot(-68+65)) \]</span>
<span class="math display">\[\alpha_{h}(V_{rest}) = 0.08\]</span></p>
<p><span class="math display">\[\beta_{n}(V_m) = 0.125exp(-0.0125(V_{m}+65)) \]</span>
<span class="math display">\[\beta_{n}(V_{rest}) = 0.125 \cdot exp(-0.0125 \cdot(-68+65)) \]</span>
<span class="math display">\[\beta_{n}(V_{rest}) = 0.13\]</span></p>
<p><span class="math display">\[\beta_{m}(V_{m}) = 4exp(-0.0556(V_{m}+65)) \]</span>
<span class="math display">\[\beta_{m}(V_{rest}) = 4 \cdot exp(-0.0556 \cdot(-68+65)) \]</span>
<span class="math display">\[\beta_{m}(V_{rest}) = 4.73\]</span></p>
<p><span class="math display">\[\beta_{h}(V_{m}) = \frac{1}{1+exp(-0.1(V_{m}+35))} \]</span>
<span class="math display">\[\beta_{h}(V_{rest}) = \frac{1}{1+exp(-0.1(-68+35))} \]</span>
<span class="math display">\[\beta_{h}(V_{rest}) = 0.036\]</span></p>
<p>Now, with each of our <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> values, we can calculate our gating variables:</p>
<p><span class="math display">\[n_\infty = \frac{\alpha_n}{\alpha_n+\beta_n}\]</span>
<span class="math display">\[n_\infty = \frac{0.049}{0.049+0.13} = 0.274\]</span></p>
<p><span class="math display">\[m_\infty = \frac{\alpha_m}{\alpha_m+\beta_m}\]</span>
<span class="math display">\[m_\infty = \frac{0.18}{0.18+4.73} = 0.037\]</span></p>
<p><span class="math display">\[h_\infty = \frac{\alpha_h}{\alpha_h+\beta_h}\]</span>
<span class="math display">\[h_\infty = \frac{0.08}{0.08+0.036} = 0.690\]</span></p>
<p><em>Step 3: Calculate <span class="math inline">\(g_L\)</span> from resistance units</em>. Remember that <span class="math inline">\(g = \frac{1}{R}\)</span>!
<span class="math display">\[g_L = (1/R) = (1/(1/3)) = 3 mS/mm^2\]</span>
<em>Step 4: Solve for <span class="math inline">\(g_K\)</span></em> Remember that from Kirchhoff’s Law that the algebraic sum of all the currents entering and leaving a junction must be equal to 0. Therefore:</p>
<p><span class="math display">\[0 = g_{Na} \cdot m^3h(V_m-E_{Na}) + g_K \cdot n^4 (V_m-E_K) + g_L \cdot (V_m-E_L)\]</span>
And we may plug in the values that we already have:<br />
<span class="math display">\[0 = 1200 \cdot 0.037^30.69 \cdot(-68-50) + g_K \cdot 0.274^4 \cdot (-68--77) + 3 \cdot (-68--54.387)\]</span>
<span class="math display">\[0 = 4.956 + g_K \cdot 0.051 + (-40.84)\]</span>
<span class="math display">\[g_K = 703.6\]</span></p>
<p><strong>Worked Example:</strong>
The voltage of a neuron is clamped at -20 mV, depolarized from its resting potential of -65 mV. The steady-state values of the gating variables in the two conditions are shown below. Comment on what these changes mean for the neuron’s behavior.</p>
<table>
<thead>
<tr class="header">
<th>V=-65 mV</th>
<th>V=-20mV</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>m=0.0529</td>
<td>m=0.875</td>
</tr>
<tr class="even">
<td>n=0.3177</td>
<td>n=0.820</td>
</tr>
<tr class="odd">
<td>h=0.5961</td>
<td>h=0.009</td>
</tr>
</tbody>
</table>
<p><em>Answer</em> The value of <em>m</em> represents the probability of voltage-gated Na+ channels to be open. This probability increases as the cell depolarizes. The <em>n</em> value represents the probability that the voltage-gated K+ channel is open. Like the Na+ channels, this probability increases with depolarization, but not to the same extent. The <em>h</em> values represent the probability of Na+ channel inactivation. This decreases significantly with depolarization because we have not hit the peak of the action potential. It is fair to assume that the h value will increase as we near the peak.</p>
</div>
<div id="summary" class="section level2">
<h2><span class="header-section-number">5.4</span> Summary</h2>
<p>An action potential is the electro-chemical signal that propagates down a neuron. Action potentials are facilitated by the electrochemical gradient that is maintained through the action of the Sodium-Potassium Pump. The role that each ion plays within the action potential can be determined through the use of the Nernst Equation, which allows us to understand the movement of a specific ion at a specific membrane voltage. Understanding the role of ions, is important, but this is not how we actually graph an action potential. One of the first modules developed to graph an action potential was the integrate and fire module. This equation disregarded all of the biomechanical features of an action potential and focused on the subthreshold membrane dynamics of a neuron. This model was relatively effective, until Hodgkin and Huxley reassessed it and changed the single leak resistance in integrate and fire to three separate resistance terms. Hodgkin and Huxley in doing this created an equation that more thoroughly analyzed and depicted the very action potential that is displayed to this day.</p>
</div>
<div id="exercises" class="section level2">
<h2><span class="header-section-number">5.5</span> Exercises:</h2>
<div id="conceptual-exercises" class="section level3">
<h3><span class="header-section-number">5.5.1</span> Conceptual Exercises:</h3>
<ol style="list-style-type: decimal">
<li>Briefly explain how the Zombie Squid moves. Why is this important to understand?<br />
</li>
<li>Action potentials are characterized by both negative and positive feedback. Provide one example of each that takes place during an action potential.<br />
</li>
<li>Describe one difference between the leaky integrate and fire model and the Hodgkin and Huxley model.<br />
</li>
<li>Why does depolarization not continue indefinitely once voltage-gated Na+ channels have opened?<br />
</li>
<li>Describe the specific stages of the action potential. How are these stages relate to positive/negative feedback? What kinds of channels are open/closed during the respective stages?</li>
</ol>
</div>
<div id="coding-exercises" class="section level3">
<h3><span class="header-section-number">5.5.2</span> Coding Exercises:</h3>
<p>Welcome to the coding problems for the Hodgkin and Huxley model! These exercises will help you get comfortable with using the Hodgkin and Huxley Model in different settings. To get started, simply run the following cell to create a few custom functions that we will be using for these exercises. No changes are needed, but feel free to look through the code and descriptive comments to see how each aspect of the model is implemented!</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="Ch4.html#cb17-1"></a><span class="co"># Import necessary libraries</span></span>
<span id="cb17-2"><a href="Ch4.html#cb17-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-3"><a href="Ch4.html#cb17-3"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb17-4"><a href="Ch4.html#cb17-4"></a></span>
<span id="cb17-5"><a href="Ch4.html#cb17-5"></a><span class="co">#Creates a custom Hodgkin and Huxley function</span></span>
<span id="cb17-6"><a href="Ch4.html#cb17-6"></a><span class="kw">def</span> HHmodel(Ie, dt, tFinal, tStimStart, tStimEnd, RestingPotential):</span>
<span id="cb17-7"><a href="Ch4.html#cb17-7"></a>    <span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb17-8"><a href="Ch4.html#cb17-8"></a>    <span class="co"># Defines the model parameters</span></span>
<span id="cb17-9"><a href="Ch4.html#cb17-9"></a>    c     <span class="op">=</span>  <span class="dv">10</span> <span class="co"># capacitance per unit area (nF/mm^2)</span></span>
<span id="cb17-10"><a href="Ch4.html#cb17-10"></a>    gMaxL <span class="op">=</span>  <span class="dv">3</span> <span class="co"># leak maximal conductance per unit area (mS/mm^2)</span></span>
<span id="cb17-11"><a href="Ch4.html#cb17-11"></a>    EL    <span class="op">=</span>  <span class="fl">-54.387</span> <span class="co"># leak conductance reversal potential (mV)</span></span>
<span id="cb17-12"><a href="Ch4.html#cb17-12"></a>    gMaxK <span class="op">=</span>  <span class="dv">360</span> <span class="co"># maximal K conductance per unit area (mS/mm^2)</span></span>
<span id="cb17-13"><a href="Ch4.html#cb17-13"></a>    EK    <span class="op">=</span>  <span class="dv">-77</span> <span class="co"># K conductance reversal potential (mV)</span></span>
<span id="cb17-14"><a href="Ch4.html#cb17-14"></a>    gMaxNa<span class="op">=</span>  <span class="dv">1200</span> <span class="co"># maximal Na conductance per unit area (mS/mm^2)</span></span>
<span id="cb17-15"><a href="Ch4.html#cb17-15"></a>    ENa   <span class="op">=</span>  <span class="dv">50</span> <span class="co"># Na conductance reversal potential (mV)</span></span>
<span id="cb17-16"><a href="Ch4.html#cb17-16"></a></span>
<span id="cb17-17"><a href="Ch4.html#cb17-17"></a>    <span class="co"># sets up data structures to hold relevant variable vectors</span></span>
<span id="cb17-18"><a href="Ch4.html#cb17-18"></a>    timeVec <span class="op">=</span> np.arange(<span class="dv">0</span>,tFinal, dt)</span>
<span id="cb17-19"><a href="Ch4.html#cb17-19"></a>    voltageVector <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb17-20"><a href="Ch4.html#cb17-20"></a>    Ivector <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb17-21"><a href="Ch4.html#cb17-21"></a>    mVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb17-22"><a href="Ch4.html#cb17-22"></a>    hVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb17-23"><a href="Ch4.html#cb17-23"></a>    nVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb17-24"><a href="Ch4.html#cb17-24"></a>    tauVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb17-25"><a href="Ch4.html#cb17-25"></a></span>
<span id="cb17-26"><a href="Ch4.html#cb17-26"></a>    <span class="co"># assigns the initial value of each variable</span></span>
<span id="cb17-27"><a href="Ch4.html#cb17-27"></a>    voltageVector[<span class="dv">0</span>] <span class="op">=</span>  RestingPotential </span>
<span id="cb17-28"><a href="Ch4.html#cb17-28"></a>    mVec[<span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.0529</span></span>
<span id="cb17-29"><a href="Ch4.html#cb17-29"></a>    hVec[<span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.5961</span></span>
<span id="cb17-30"><a href="Ch4.html#cb17-30"></a>    nVec[<span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.3177</span></span>
<span id="cb17-31"><a href="Ch4.html#cb17-31"></a></span>
<span id="cb17-32"><a href="Ch4.html#cb17-32"></a>    <span class="co"># defines the stimulus</span></span>
<span id="cb17-33"><a href="Ch4.html#cb17-33"></a>    tStimStart <span class="op">=</span> <span class="bu">int</span>(tStimStart<span class="op">/</span>dt) </span>
<span id="cb17-34"><a href="Ch4.html#cb17-34"></a>    tStimEnd <span class="op">=</span> <span class="bu">int</span>(tStimEnd<span class="op">/</span>dt) </span>
<span id="cb17-35"><a href="Ch4.html#cb17-35"></a>    Ivector[tStimStart:tStimEnd] <span class="op">=</span> Ie </span>
<span id="cb17-36"><a href="Ch4.html#cb17-36"></a></span>
<span id="cb17-37"><a href="Ch4.html#cb17-37"></a>    <span class="co"># For-loop integrates equations into model</span></span>
<span id="cb17-38"><a href="Ch4.html#cb17-38"></a>    <span class="cf">for</span> v <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(timeVec)<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb17-39"><a href="Ch4.html#cb17-39"></a>        <span class="co"># Calculates alpha values for m, h, and n</span></span>
<span id="cb17-40"><a href="Ch4.html#cb17-40"></a>        alpha_n <span class="op">=</span> <span class="fl">0.01</span><span class="op">*</span>(voltageVector[v] <span class="op">+</span> <span class="dv">55</span>) <span class="op">/</span> </span>
<span id="cb17-41"><a href="Ch4.html#cb17-41"></a>          (<span class="dv">1</span><span class="op">-</span>np.exp(<span class="op">-</span><span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">55</span>)))</span>
<span id="cb17-42"><a href="Ch4.html#cb17-42"></a>        alpha_m <span class="op">=</span> (<span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">40</span>))<span class="op">/</span></span>
<span id="cb17-43"><a href="Ch4.html#cb17-43"></a>          (<span class="dv">1</span><span class="op">-</span>np.exp(<span class="op">-</span><span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">40</span>)))</span>
<span id="cb17-44"><a href="Ch4.html#cb17-44"></a>        alpha_h <span class="op">=</span> <span class="fl">0.07</span><span class="op">*</span>np.exp(<span class="op">-</span>.<span class="dv">05</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">65</span>))</span>
<span id="cb17-45"><a href="Ch4.html#cb17-45"></a>    </span>
<span id="cb17-46"><a href="Ch4.html#cb17-46"></a>        <span class="co"># Calculates beta values for m, h, and n</span></span>
<span id="cb17-47"><a href="Ch4.html#cb17-47"></a>        beta_n <span class="op">=</span> <span class="fl">0.125</span><span class="op">*</span>np.exp(<span class="op">-</span>.<span class="dv">01125</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">55</span>))</span>
<span id="cb17-48"><a href="Ch4.html#cb17-48"></a>        beta_m <span class="op">=</span> <span class="dv">4</span><span class="op">*</span>np.exp(<span class="op">-</span>.<span class="dv">05556</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">65</span>))</span>
<span id="cb17-49"><a href="Ch4.html#cb17-49"></a>        beta_h <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span><span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">35</span>)))</span>
<span id="cb17-50"><a href="Ch4.html#cb17-50"></a>    </span>
<span id="cb17-51"><a href="Ch4.html#cb17-51"></a>        <span class="co"># Calculates tau values for m, h, and n</span></span>
<span id="cb17-52"><a href="Ch4.html#cb17-52"></a>        tau_n <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (alpha_n <span class="op">+</span> beta_n)</span>
<span id="cb17-53"><a href="Ch4.html#cb17-53"></a>        tau_m <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (alpha_m <span class="op">+</span> beta_m)</span>
<span id="cb17-54"><a href="Ch4.html#cb17-54"></a>        tau_h <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (alpha_h <span class="op">+</span> beta_h)</span>
<span id="cb17-55"><a href="Ch4.html#cb17-55"></a>    </span>
<span id="cb17-56"><a href="Ch4.html#cb17-56"></a>        <span class="co"># Calculates inf values for m, h, and n</span></span>
<span id="cb17-57"><a href="Ch4.html#cb17-57"></a>        pm <span class="op">=</span> alpha_m<span class="op">/</span>(alpha_m <span class="op">+</span> beta_m)</span>
<span id="cb17-58"><a href="Ch4.html#cb17-58"></a>        pn <span class="op">=</span> alpha_n<span class="op">/</span>(alpha_n<span class="op">+</span> beta_n)</span>
<span id="cb17-59"><a href="Ch4.html#cb17-59"></a>        ph <span class="op">=</span> alpha_h<span class="op">/</span>(alpha_h <span class="op">+</span> beta_h)</span>
<span id="cb17-60"><a href="Ch4.html#cb17-60"></a>    </span>
<span id="cb17-61"><a href="Ch4.html#cb17-61"></a>        <span class="co"># Calculates and store values in m, h, and n vectors</span></span>
<span id="cb17-62"><a href="Ch4.html#cb17-62"></a>        mVec[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> pm <span class="op">+</span> (mVec[v] <span class="op">-</span> pm)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tau_m)</span>
<span id="cb17-63"><a href="Ch4.html#cb17-63"></a>        nVec[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> pn <span class="op">+</span> (nVec[v] <span class="op">-</span> pn)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tau_n)</span>
<span id="cb17-64"><a href="Ch4.html#cb17-64"></a>        hVec[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> ph <span class="op">+</span> (hVec[v] <span class="op">-</span> ph)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tau_h)</span>
<span id="cb17-65"><a href="Ch4.html#cb17-65"></a>    </span>
<span id="cb17-66"><a href="Ch4.html#cb17-66"></a>        <span class="co"># Updates Vinf and tauV</span></span>
<span id="cb17-67"><a href="Ch4.html#cb17-67"></a>        denominator <span class="op">=</span> gMaxL <span class="op">+</span> gMaxK<span class="op">*</span>(nVec[v]<span class="op">**</span><span class="dv">4</span>) <span class="op">+</span> </span>
<span id="cb17-68"><a href="Ch4.html#cb17-68"></a>          gMaxNa<span class="op">*</span>(mVec[v]<span class="op">**</span><span class="dv">3</span>)<span class="op">*</span>hVec[v]</span>
<span id="cb17-69"><a href="Ch4.html#cb17-69"></a>        tauV <span class="op">=</span> c <span class="op">/</span> denominator</span>
<span id="cb17-70"><a href="Ch4.html#cb17-70"></a>        Vinf <span class="op">=</span> ((gMaxL)<span class="op">*</span>EL <span class="op">+</span> gMaxK<span class="op">*</span>(nVec[v]<span class="op">**</span><span class="dv">4</span>)<span class="op">*</span>EK <span class="op">+</span> </span>
<span id="cb17-71"><a href="Ch4.html#cb17-71"></a>          gMaxNa<span class="op">*</span>(mVec[v]<span class="op">**</span><span class="dv">3</span>)<span class="op">*</span>hVec[v]<span class="op">*</span>ENa <span class="op">+</span> Ivector[v])<span class="op">/</span>denominator  </span>
<span id="cb17-72"><a href="Ch4.html#cb17-72"></a>        </span>
<span id="cb17-73"><a href="Ch4.html#cb17-73"></a>        <span class="co"># Calculates and store next voltage value in vector</span></span>
<span id="cb17-74"><a href="Ch4.html#cb17-74"></a>        voltageVector[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> Vinf <span class="op">+</span> (voltageVector[v]<span class="op">-</span>Vinf)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tauV) </span>
<span id="cb17-75"><a href="Ch4.html#cb17-75"></a>    </span>
<span id="cb17-76"><a href="Ch4.html#cb17-76"></a>    <span class="co"># Plotting</span></span>
<span id="cb17-77"><a href="Ch4.html#cb17-77"></a>    plt.figure(<span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">10</span>))</span>
<span id="cb17-78"><a href="Ch4.html#cb17-78"></a>    plt.subplot(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb17-79"><a href="Ch4.html#cb17-79"></a>    plt.plot(timeVec,voltageVector)</span>
<span id="cb17-80"><a href="Ch4.html#cb17-80"></a>    plt.title(<span class="st">&#39;Hodgkin and Huxley Simulation&#39;</span>)</span>
<span id="cb17-81"><a href="Ch4.html#cb17-81"></a>    plt.ylabel(<span class="st">&#39;Voltage in mV&#39;</span>)</span>
<span id="cb17-82"><a href="Ch4.html#cb17-82"></a>    plt.subplot(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb17-83"><a href="Ch4.html#cb17-83"></a>    plt.plot(timeVec, mVec)</span>
<span id="cb17-84"><a href="Ch4.html#cb17-84"></a>    plt.ylabel(<span class="st">&#39;g_Na activation variable m&#39;</span>)</span>
<span id="cb17-85"><a href="Ch4.html#cb17-85"></a>    plt.subplot(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb17-86"><a href="Ch4.html#cb17-86"></a>    plt.plot(timeVec, hVec)</span>
<span id="cb17-87"><a href="Ch4.html#cb17-87"></a>    plt.ylabel(<span class="st">&#39;g_Na inactivation variable h&#39;</span>)</span>
<span id="cb17-88"><a href="Ch4.html#cb17-88"></a>    plt.subplot(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">4</span>)</span>
<span id="cb17-89"><a href="Ch4.html#cb17-89"></a>    plt.plot(timeVec, nVec)</span>
<span id="cb17-90"><a href="Ch4.html#cb17-90"></a>    plt.ylabel(<span class="st">&#39;g_K activation variable&#39;</span>)</span>
<span id="cb17-91"><a href="Ch4.html#cb17-91"></a>    plt.xlabel(<span class="st">&#39;Time in ms&#39;</span>)</span>
<span id="cb17-92"><a href="Ch4.html#cb17-92"></a>    </span>
<span id="cb17-93"><a href="Ch4.html#cb17-93"></a>    </span>
<span id="cb17-94"><a href="Ch4.html#cb17-94"></a><span class="co">#creates a custom function that will determine the minimum Ie</span></span>
<span id="cb17-95"><a href="Ch4.html#cb17-95"></a><span class="co"># required to surpass the threshold potential</span></span>
<span id="cb17-96"><a href="Ch4.html#cb17-96"></a></span>
<span id="cb17-97"><a href="Ch4.html#cb17-97"></a><span class="kw">def</span> HHmodel_threshold(Ie):</span>
<span id="cb17-98"><a href="Ch4.html#cb17-98"></a>    tStimStart <span class="op">=</span> <span class="dv">250</span></span>
<span id="cb17-99"><a href="Ch4.html#cb17-99"></a>    tStimEnd   <span class="op">=</span> <span class="dv">750</span></span>
<span id="cb17-100"><a href="Ch4.html#cb17-100"></a>    dt          <span class="op">=</span> <span class="fl">0.1</span> <span class="co"># time step (ms)</span></span>
<span id="cb17-101"><a href="Ch4.html#cb17-101"></a>    tFinal      <span class="op">=</span> <span class="dv">1000</span> <span class="co"># total time of run (ms)</span></span>
<span id="cb17-102"><a href="Ch4.html#cb17-102"></a>    RestingPotential <span class="op">=</span> <span class="dv">-65</span></span>
<span id="cb17-103"><a href="Ch4.html#cb17-103"></a>    c     <span class="op">=</span> <span class="dv">10</span> <span class="co"># capacitance per unit area (nF/mm^2)</span></span>
<span id="cb17-104"><a href="Ch4.html#cb17-104"></a>    gMaxL <span class="op">=</span> <span class="dv">3</span> <span class="co"># leak maximal conductance per unit area (mS/mm^2)</span></span>
<span id="cb17-105"><a href="Ch4.html#cb17-105"></a>    EL    <span class="op">=</span>  <span class="fl">-54.387</span> <span class="co"># leak conductance reversal potential (mV)</span></span>
<span id="cb17-106"><a href="Ch4.html#cb17-106"></a>    gMaxK <span class="op">=</span>  <span class="dv">360</span> <span class="co"># maximal K conductance per unit area (mS/mm^2)</span></span>
<span id="cb17-107"><a href="Ch4.html#cb17-107"></a>    EK    <span class="op">=</span>  <span class="dv">-77</span> <span class="co"># K conductance reversal potential (mV)</span></span>
<span id="cb17-108"><a href="Ch4.html#cb17-108"></a>    gMaxNa<span class="op">=</span>  <span class="dv">1200</span> <span class="co"># maximal Na conductance per unit area (mS/mm^2)</span></span>
<span id="cb17-109"><a href="Ch4.html#cb17-109"></a>    ENa   <span class="op">=</span>  <span class="dv">50</span> <span class="co"># Na conductance reversal potential (mV)</span></span>
<span id="cb17-110"><a href="Ch4.html#cb17-110"></a>    </span>
<span id="cb17-111"><a href="Ch4.html#cb17-111"></a>    </span>
<span id="cb17-112"><a href="Ch4.html#cb17-112"></a>    <span class="cf">for</span> current <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(Ie)):</span>
<span id="cb17-113"><a href="Ch4.html#cb17-113"></a>    </span>
<span id="cb17-114"><a href="Ch4.html#cb17-114"></a>        timeVec <span class="op">=</span> np.arange(<span class="dv">0</span>,tFinal, dt)</span>
<span id="cb17-115"><a href="Ch4.html#cb17-115"></a>        voltageVector <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb17-116"><a href="Ch4.html#cb17-116"></a>        Ivector <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb17-117"><a href="Ch4.html#cb17-117"></a>        mVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb17-118"><a href="Ch4.html#cb17-118"></a>        hVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb17-119"><a href="Ch4.html#cb17-119"></a>        nVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb17-120"><a href="Ch4.html#cb17-120"></a>        tauVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb17-121"><a href="Ch4.html#cb17-121"></a>        voltageVector[<span class="dv">0</span>] <span class="op">=</span>  RestingPotential </span>
<span id="cb17-122"><a href="Ch4.html#cb17-122"></a>        mVec[<span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.0529</span></span>
<span id="cb17-123"><a href="Ch4.html#cb17-123"></a>        hVec[<span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.5961</span></span>
<span id="cb17-124"><a href="Ch4.html#cb17-124"></a>        nVec[<span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.3177</span></span>
<span id="cb17-125"><a href="Ch4.html#cb17-125"></a></span>
<span id="cb17-126"><a href="Ch4.html#cb17-126"></a>        Ivector[<span class="dv">2499</span>:<span class="dv">7499</span>] <span class="op">=</span> Ie[current]</span>
<span id="cb17-127"><a href="Ch4.html#cb17-127"></a>        </span>
<span id="cb17-128"><a href="Ch4.html#cb17-128"></a>        <span class="cf">for</span> v <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(timeVec)<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb17-129"><a href="Ch4.html#cb17-129"></a>            alpha_n <span class="op">=</span> <span class="fl">0.01</span><span class="op">*</span>(voltageVector[v] <span class="op">+</span> <span class="dv">55</span>) <span class="op">/</span> </span>
<span id="cb17-130"><a href="Ch4.html#cb17-130"></a>              (<span class="dv">1</span><span class="op">-</span>np.exp(<span class="op">-</span><span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">55</span>)))</span>
<span id="cb17-131"><a href="Ch4.html#cb17-131"></a>            alpha_m <span class="op">=</span> (<span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">40</span>))<span class="op">/</span></span>
<span id="cb17-132"><a href="Ch4.html#cb17-132"></a>              (<span class="dv">1</span><span class="op">-</span>np.exp(<span class="op">-</span><span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">40</span>)))</span>
<span id="cb17-133"><a href="Ch4.html#cb17-133"></a>            alpha_h <span class="op">=</span> <span class="fl">0.07</span><span class="op">*</span>np.exp(<span class="op">-</span>.<span class="dv">05</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">65</span>))</span>
<span id="cb17-134"><a href="Ch4.html#cb17-134"></a>            beta_n <span class="op">=</span> <span class="fl">0.125</span><span class="op">*</span>np.exp(<span class="op">-</span>.<span class="dv">01125</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">55</span>))</span>
<span id="cb17-135"><a href="Ch4.html#cb17-135"></a>            beta_m <span class="op">=</span> <span class="dv">4</span><span class="op">*</span>np.exp(<span class="op">-</span>.<span class="dv">05556</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">65</span>))</span>
<span id="cb17-136"><a href="Ch4.html#cb17-136"></a>            beta_h <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span><span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">35</span>)))</span>
<span id="cb17-137"><a href="Ch4.html#cb17-137"></a>            tau_n <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (alpha_n <span class="op">+</span> beta_n)</span>
<span id="cb17-138"><a href="Ch4.html#cb17-138"></a>            tau_m <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (alpha_m <span class="op">+</span> beta_m)</span>
<span id="cb17-139"><a href="Ch4.html#cb17-139"></a>            tau_h <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (alpha_h <span class="op">+</span> beta_h)</span>
<span id="cb17-140"><a href="Ch4.html#cb17-140"></a>            pm <span class="op">=</span> alpha_m<span class="op">/</span>(alpha_m <span class="op">+</span> beta_m)</span>
<span id="cb17-141"><a href="Ch4.html#cb17-141"></a>            pn <span class="op">=</span> alpha_n<span class="op">/</span>(alpha_n<span class="op">+</span> beta_n)</span>
<span id="cb17-142"><a href="Ch4.html#cb17-142"></a>            ph <span class="op">=</span> alpha_h<span class="op">/</span>(alpha_h <span class="op">+</span> beta_h)</span>
<span id="cb17-143"><a href="Ch4.html#cb17-143"></a>            mVec[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> pm <span class="op">+</span> (mVec[v] <span class="op">-</span> pm)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tau_m)</span>
<span id="cb17-144"><a href="Ch4.html#cb17-144"></a>            nVec[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> pn <span class="op">+</span> (nVec[v] <span class="op">-</span> pn)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tau_n)</span>
<span id="cb17-145"><a href="Ch4.html#cb17-145"></a>            hVec[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> ph <span class="op">+</span> (hVec[v] <span class="op">-</span> ph)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tau_h)</span>
<span id="cb17-146"><a href="Ch4.html#cb17-146"></a>            denominator <span class="op">=</span> gMaxL <span class="op">+</span> gMaxK<span class="op">*</span>(nVec[v]<span class="op">**</span><span class="dv">4</span>) <span class="op">+</span> </span>
<span id="cb17-147"><a href="Ch4.html#cb17-147"></a>              gMaxNa<span class="op">*</span>(mVec[v]<span class="op">**</span><span class="dv">3</span>)<span class="op">*</span>hVec[v]</span>
<span id="cb17-148"><a href="Ch4.html#cb17-148"></a>            tauV <span class="op">=</span> c <span class="op">/</span> denominator</span>
<span id="cb17-149"><a href="Ch4.html#cb17-149"></a>            Vinf <span class="op">=</span> ((gMaxL)<span class="op">*</span>EL <span class="op">+</span> gMaxK<span class="op">*</span>(nVec[v]<span class="op">**</span><span class="dv">4</span>)<span class="op">*</span>EK <span class="op">+</span> </span>
<span id="cb17-150"><a href="Ch4.html#cb17-150"></a>              gMaxNa<span class="op">*</span>(mVec[v]<span class="op">**</span><span class="dv">3</span>)<span class="op">*</span>hVec[v]<span class="op">*</span>ENa <span class="op">+</span> Ivector[v])<span class="op">/</span> denominator   </span>
<span id="cb17-151"><a href="Ch4.html#cb17-151"></a>            voltageVector[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> Vinf <span class="op">+</span> </span>
<span id="cb17-152"><a href="Ch4.html#cb17-152"></a>              (voltageVector[v]<span class="op">-</span>Vinf)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tauV) </span>
<span id="cb17-153"><a href="Ch4.html#cb17-153"></a>            </span>
<span id="cb17-154"><a href="Ch4.html#cb17-154"></a>            <span class="co"># Checks to see if the given current resulted in an </span></span>
<span id="cb17-155"><a href="Ch4.html#cb17-155"></a>            <span class="co"># action potential </span></span>
<span id="cb17-156"><a href="Ch4.html#cb17-156"></a>            <span class="co"># Values around 25 mv is only reached if the neuron spikes. </span></span>
<span id="cb17-157"><a href="Ch4.html#cb17-157"></a>            <span class="co"># A value of 20 would similarly be appropriate</span></span>
<span id="cb17-158"><a href="Ch4.html#cb17-158"></a>            <span class="cf">if</span> voltageVector[v] <span class="op">&gt;</span> <span class="dv">25</span>: </span>
<span id="cb17-159"><a href="Ch4.html#cb17-159"></a>                <span class="cf">return</span>(<span class="bu">print</span>(<span class="st">&quot;With an external current of&quot;</span>, Ie[current]<span class="op">-</span><span class="dv">1</span> ,</span>
<span id="cb17-160"><a href="Ch4.html#cb17-160"></a>                  <span class="st">&quot;nA/mm^2 threshold potential was finally reached!&quot;</span>)) </span>
<span id="cb17-161"><a href="Ch4.html#cb17-161"></a>            </span>
<span id="cb17-162"><a href="Ch4.html#cb17-162"></a>    <span class="cf">return</span>(<span class="bu">print</span>(<span class="st">&quot;Looks like you didn&#39;t provide a large value in your range </span></span>
<span id="cb17-163"><a href="Ch4.html#cb17-163"></a><span class="st">      caused the neuron to spike. Try again!&quot;</span>))</span>
<span id="cb17-164"><a href="Ch4.html#cb17-164"></a></span>
<span id="cb17-165"><a href="Ch4.html#cb17-165"></a></span>
<span id="cb17-166"><a href="Ch4.html#cb17-166"></a><span class="co"># plots the behavior of a neuron when injected with different </span></span>
<span id="cb17-167"><a href="Ch4.html#cb17-167"></a><span class="co"># currents on the same graphs</span></span>
<span id="cb17-168"><a href="Ch4.html#cb17-168"></a><span class="kw">def</span> HHmodel_compare(Ie, RestingPotential):</span>
<span id="cb17-169"><a href="Ch4.html#cb17-169"></a>    terminate <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb17-170"><a href="Ch4.html#cb17-170"></a>    tStimStart  <span class="op">=</span>  <span class="dv">10</span> </span>
<span id="cb17-171"><a href="Ch4.html#cb17-171"></a>    tStimEnd    <span class="op">=</span>  <span class="dv">30</span> </span>
<span id="cb17-172"><a href="Ch4.html#cb17-172"></a>    tFinal      <span class="op">=</span>  <span class="dv">50</span> </span>
<span id="cb17-173"><a href="Ch4.html#cb17-173"></a>    dt          <span class="op">=</span>  <span class="fl">0.002</span> </span>
<span id="cb17-174"><a href="Ch4.html#cb17-174"></a>    c           <span class="op">=</span>  <span class="dv">10</span> </span>
<span id="cb17-175"><a href="Ch4.html#cb17-175"></a>    gMaxL       <span class="op">=</span>  <span class="fl">0.003e03</span> </span>
<span id="cb17-176"><a href="Ch4.html#cb17-176"></a>    EL          <span class="op">=</span>  <span class="fl">-54.387</span> </span>
<span id="cb17-177"><a href="Ch4.html#cb17-177"></a>    gMaxK       <span class="op">=</span>  <span class="fl">0.36e03</span> </span>
<span id="cb17-178"><a href="Ch4.html#cb17-178"></a>    EK          <span class="op">=</span>  <span class="dv">-77</span> </span>
<span id="cb17-179"><a href="Ch4.html#cb17-179"></a>    gMaxNa      <span class="op">=</span>  <span class="fl">1.2e03</span> </span>
<span id="cb17-180"><a href="Ch4.html#cb17-180"></a>    ENa         <span class="op">=</span>  <span class="dv">50</span> </span>
<span id="cb17-181"><a href="Ch4.html#cb17-181"></a>    </span>
<span id="cb17-182"><a href="Ch4.html#cb17-182"></a>    <span class="cf">for</span> current <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(Ie)):</span>
<span id="cb17-183"><a href="Ch4.html#cb17-183"></a>        timeVec <span class="op">=</span> np.arange(<span class="dv">0</span>,tFinal, dt)</span>
<span id="cb17-184"><a href="Ch4.html#cb17-184"></a>        voltageVector <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb17-185"><a href="Ch4.html#cb17-185"></a>        Ivector <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb17-186"><a href="Ch4.html#cb17-186"></a>        mVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb17-187"><a href="Ch4.html#cb17-187"></a>        hVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb17-188"><a href="Ch4.html#cb17-188"></a>        nVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb17-189"><a href="Ch4.html#cb17-189"></a>        tauVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb17-190"><a href="Ch4.html#cb17-190"></a>        </span>
<span id="cb17-191"><a href="Ch4.html#cb17-191"></a>        voltageVector[<span class="dv">0</span>] <span class="op">=</span> RestingPotential </span>
<span id="cb17-192"><a href="Ch4.html#cb17-192"></a>    </span>
<span id="cb17-193"><a href="Ch4.html#cb17-193"></a>        mVec[<span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.0529</span></span>
<span id="cb17-194"><a href="Ch4.html#cb17-194"></a>        hVec[<span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.5961</span></span>
<span id="cb17-195"><a href="Ch4.html#cb17-195"></a>        nVec[<span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.3177</span></span>
<span id="cb17-196"><a href="Ch4.html#cb17-196"></a></span>
<span id="cb17-197"><a href="Ch4.html#cb17-197"></a>        Ivector[<span class="dv">5000</span>:<span class="dv">15000</span>] <span class="op">=</span> Ie[current]</span>
<span id="cb17-198"><a href="Ch4.html#cb17-198"></a>        </span>
<span id="cb17-199"><a href="Ch4.html#cb17-199"></a>        <span class="cf">for</span> v <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(timeVec)<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb17-200"><a href="Ch4.html#cb17-200"></a>            alpha_n <span class="op">=</span> <span class="fl">0.01</span><span class="op">*</span>(voltageVector[v] <span class="op">+</span> <span class="dv">55</span>) <span class="op">/</span> </span>
<span id="cb17-201"><a href="Ch4.html#cb17-201"></a>              (<span class="dv">1</span><span class="op">-</span>np.exp(<span class="op">-</span><span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">55</span>)))</span>
<span id="cb17-202"><a href="Ch4.html#cb17-202"></a>            alpha_m <span class="op">=</span> (<span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">40</span>))<span class="op">/</span></span>
<span id="cb17-203"><a href="Ch4.html#cb17-203"></a>              (<span class="dv">1</span><span class="op">-</span>np.exp(<span class="op">-</span><span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">40</span>)))</span>
<span id="cb17-204"><a href="Ch4.html#cb17-204"></a>            alpha_h <span class="op">=</span> <span class="fl">0.07</span><span class="op">*</span>np.exp(<span class="op">-</span>.<span class="dv">05</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">65</span>))</span>
<span id="cb17-205"><a href="Ch4.html#cb17-205"></a>            beta_n <span class="op">=</span> <span class="fl">0.125</span><span class="op">*</span>np.exp(<span class="op">-</span>.<span class="dv">01125</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">55</span>))</span>
<span id="cb17-206"><a href="Ch4.html#cb17-206"></a>            beta_m <span class="op">=</span> <span class="dv">4</span><span class="op">*</span>np.exp(<span class="op">-</span>.<span class="dv">05556</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">65</span>))</span>
<span id="cb17-207"><a href="Ch4.html#cb17-207"></a>            beta_h <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span><span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">35</span>)))</span>
<span id="cb17-208"><a href="Ch4.html#cb17-208"></a>            tau_n <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (alpha_n <span class="op">+</span> beta_n)</span>
<span id="cb17-209"><a href="Ch4.html#cb17-209"></a>            tau_m <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (alpha_m <span class="op">+</span> beta_m)</span>
<span id="cb17-210"><a href="Ch4.html#cb17-210"></a>            tau_h <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (alpha_h <span class="op">+</span> beta_h)</span>
<span id="cb17-211"><a href="Ch4.html#cb17-211"></a>            pm <span class="op">=</span> alpha_m<span class="op">/</span>(alpha_m <span class="op">+</span> beta_m)</span>
<span id="cb17-212"><a href="Ch4.html#cb17-212"></a>            pn <span class="op">=</span> alpha_n<span class="op">/</span>(alpha_n<span class="op">+</span> beta_n)</span>
<span id="cb17-213"><a href="Ch4.html#cb17-213"></a>            ph <span class="op">=</span> alpha_h<span class="op">/</span>(alpha_h <span class="op">+</span> beta_h)</span>
<span id="cb17-214"><a href="Ch4.html#cb17-214"></a>            mVec[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> pm <span class="op">+</span> (mVec[v] <span class="op">-</span> pm)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tau_m)</span>
<span id="cb17-215"><a href="Ch4.html#cb17-215"></a>            nVec[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> pn <span class="op">+</span> (nVec[v] <span class="op">-</span> pn)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tau_n)</span>
<span id="cb17-216"><a href="Ch4.html#cb17-216"></a>            hVec[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> ph <span class="op">+</span> (hVec[v] <span class="op">-</span> ph)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tau_h)</span>
<span id="cb17-217"><a href="Ch4.html#cb17-217"></a>            denominator <span class="op">=</span> gMaxL <span class="op">+</span> gMaxK<span class="op">*</span>(nVec[v]<span class="op">**</span><span class="dv">4</span>) <span class="op">+</span> </span>
<span id="cb17-218"><a href="Ch4.html#cb17-218"></a>              gMaxNa<span class="op">*</span>(mVec[v]<span class="op">**</span><span class="dv">3</span>)<span class="op">*</span>hVec[v]</span>
<span id="cb17-219"><a href="Ch4.html#cb17-219"></a>            tauV <span class="op">=</span> c <span class="op">/</span> denominator</span>
<span id="cb17-220"><a href="Ch4.html#cb17-220"></a>            Vinf <span class="op">=</span> ((gMaxL)<span class="op">*</span>EL <span class="op">+</span> gMaxK<span class="op">*</span>(nVec[v]<span class="op">**</span><span class="dv">4</span>)<span class="op">*</span>EK <span class="op">+</span> </span>
<span id="cb17-221"><a href="Ch4.html#cb17-221"></a>              gMaxNa<span class="op">*</span>(mVec[v]<span class="op">**</span><span class="dv">3</span>)<span class="op">*</span>hVec[v]<span class="op">*</span>ENa <span class="op">+</span> Ivector[v])<span class="op">/</span> </span>
<span id="cb17-222"><a href="Ch4.html#cb17-222"></a>                denominator   </span>
<span id="cb17-223"><a href="Ch4.html#cb17-223"></a>            voltageVector[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> Vinf <span class="op">+</span> </span>
<span id="cb17-224"><a href="Ch4.html#cb17-224"></a>              (voltageVector[v]<span class="op">-</span>Vinf)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tauV)</span>
<span id="cb17-225"><a href="Ch4.html#cb17-225"></a>        </span>
<span id="cb17-226"><a href="Ch4.html#cb17-226"></a>            <span class="co"># stores values so the two plots can be superimposed</span></span>
<span id="cb17-227"><a href="Ch4.html#cb17-227"></a>            <span class="cf">if</span> terminate <span class="op">==</span><span class="dv">0</span>:</span>
<span id="cb17-228"><a href="Ch4.html#cb17-228"></a>                Mv <span class="op">=</span> mVec</span>
<span id="cb17-229"><a href="Ch4.html#cb17-229"></a>                Nv <span class="op">=</span> nVec</span>
<span id="cb17-230"><a href="Ch4.html#cb17-230"></a>                Hv <span class="op">=</span> hVec</span>
<span id="cb17-231"><a href="Ch4.html#cb17-231"></a>                Vv <span class="op">=</span> voltageVector</span>
<span id="cb17-232"><a href="Ch4.html#cb17-232"></a>                terminate <span class="op">=</span> <span class="dv">1</span> </span>
<span id="cb17-233"><a href="Ch4.html#cb17-233"></a>              </span>
<span id="cb17-234"><a href="Ch4.html#cb17-234"></a>    <span class="co">#plotting</span></span>
<span id="cb17-235"><a href="Ch4.html#cb17-235"></a>    plt.figure(<span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">10</span>))</span>
<span id="cb17-236"><a href="Ch4.html#cb17-236"></a>    plt.subplot(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb17-237"><a href="Ch4.html#cb17-237"></a>    plt.plot(timeVec,voltageVector, timeVec, Vv)</span>
<span id="cb17-238"><a href="Ch4.html#cb17-238"></a>    plt.title(<span class="st">&#39;Hodgkin and Huxley Simulation&#39;</span>)</span>
<span id="cb17-239"><a href="Ch4.html#cb17-239"></a>    plt.ylabel(<span class="st">&#39;Voltage in mV&#39;</span>)</span>
<span id="cb17-240"><a href="Ch4.html#cb17-240"></a>    plt.subplot(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb17-241"><a href="Ch4.html#cb17-241"></a>    plt.plot(timeVec, mVec, timeVec, Mv)</span>
<span id="cb17-242"><a href="Ch4.html#cb17-242"></a>    plt.ylabel(<span class="st">&#39;g_Na activation variable m&#39;</span>)</span>
<span id="cb17-243"><a href="Ch4.html#cb17-243"></a>    plt.subplot(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb17-244"><a href="Ch4.html#cb17-244"></a>    plt.plot(timeVec, hVec, timeVec, Hv)</span>
<span id="cb17-245"><a href="Ch4.html#cb17-245"></a>    plt.ylabel(<span class="st">&#39;g_Na inactivation variable h&#39;</span>)</span>
<span id="cb17-246"><a href="Ch4.html#cb17-246"></a>    plt.subplot(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">4</span>)</span>
<span id="cb17-247"><a href="Ch4.html#cb17-247"></a>    plt.plot(timeVec, nVec, timeVec, Nv)</span>
<span id="cb17-248"><a href="Ch4.html#cb17-248"></a>    plt.ylabel(<span class="st">&#39;g_K activation variable&#39;</span>)</span>
<span id="cb17-249"><a href="Ch4.html#cb17-249"></a>    plt.xlabel(<span class="st">&#39;Time in ms&#39;</span>)</span>
<span id="cb17-250"><a href="Ch4.html#cb17-250"></a></span>
<span id="cb17-251"><a href="Ch4.html#cb17-251"></a></span>
<span id="cb17-252"><a href="Ch4.html#cb17-252"></a><span class="bu">print</span>(<span class="st">&quot;Cell run successfully! Please proceed to the next part&quot;</span>)</span></code></pre></div>
<p><strong>Problem 1: Exploring the Model</strong>
<em>Part 1</em>
What can the model do? The function HHmodel() provides insight by simulating a neuron firing and the behavior of its channel gating variables under various conditions. Simulate an experiment that runs for 500 ms in which a neuron is exposed to a current of 100 <span class="math inline">\(nA/mm^2\)</span> from 100-400 ms. Use time steps of 0.1 ms and set the resting potential to -65 mV.</p>
<p>Note, the code has been started for you - set the variables to their specified values and run the code.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="Ch4.html#cb18-1"></a>tStimStart  <span class="op">=</span>            <span class="co"># time to start injecting current (ms)</span></span>
<span id="cb18-2"><a href="Ch4.html#cb18-2"></a>tStimEnd    <span class="op">=</span>            <span class="co"># time to end injecting current (ms)</span></span>
<span id="cb18-3"><a href="Ch4.html#cb18-3"></a>tFinal      <span class="op">=</span>            <span class="co"># total time of run (ms)</span></span>
<span id="cb18-4"><a href="Ch4.html#cb18-4"></a>dt          <span class="op">=</span>            <span class="co"># time step (ms)</span></span>
<span id="cb18-5"><a href="Ch4.html#cb18-5"></a>Ie          <span class="op">=</span>            <span class="co"># nA/mm^2</span></span>
<span id="cb18-6"><a href="Ch4.html#cb18-6"></a>RestingPotential <span class="op">=</span>       <span class="co">#mv</span></span>
<span id="cb18-7"><a href="Ch4.html#cb18-7"></a></span>
<span id="cb18-8"><a href="Ch4.html#cb18-8"></a><span class="co"># Run the custom function</span></span>
<span id="cb18-9"><a href="Ch4.html#cb18-9"></a>HHmodel(Ie, dt, tFinal, tStimStart, tStimEnd, RestingPotential)</span></code></pre></div>
<p><em>Part 2</em> Nice work! Does increasing the injected current increasing the firing rate? Using the same code, increase the injected current to 250 <span class="math inline">\(nA/mm^2\)</span> to find out!</p>
<p><em>Part 3, optional</em> Play around with the parameters to see how changing the neuron’s starting conditions will affect its behavior!</p>
<p><strong>Problem 2: Threshold Potential</strong>
<em>Part 1</em> Neurons operate on a “all or nothing” basis. The function HHmodel_threshold() takes different values of injected currents (<span class="math inline">\(I_e\)</span>) and returns the minimum value that elicited an action potential. Using <em>np.arange()</em>, set <span class="math inline">\(I_e\)</span> equal to a vector of increasing voltages to determine the minimum injected current required for the neuron to cross its threshold potential. Hint: first define your external stimulation, <span class="math inline">\(I_e\)</span> then use the HHmodel_threshold() function.</p>
<p><em>Part 2</em> The function HHmodel_compare() will plot the behavior of a neuron and its gating variables for two different injected current values. The function’s input is the array <span class="math inline">\(I_e\)</span> that contains two values. Using the external current determined in part one and the preceding integer, run the code to see the difference between just missing and passing the threshold potential!</p>
<p><em>Part 3</em> Pretty striking difference right? Now imagine there is a neuron where the resting potential is -60 mV rather than -65. What would happen if all else remained equal? Change the resting potential to -60 mV and rerun the code to find out!(Note: HHmodel_compare() also accepts an input for the resting potential.)</p>
<p><strong>Problem 3: Pick your Poison(s)</strong>
<em>Part 1</em> The poisonous dart frog of Central and South America secretes the neurotoxin batrachotoxin (BTX). Exposure to BTX results causes paralysis by irreversibly binding to the sodium channels and preventing them from closing. In the following code, simulate a neuron’s exposure to BTX by setting the relevant variable to the appropriate value. Note: the only code that should be altered has been sectioned off using hashtags.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="Ch4.html#cb19-1"></a><span class="co"># Define input parameters</span></span>
<span id="cb19-2"><a href="Ch4.html#cb19-2"></a>c           <span class="op">=</span>  <span class="dv">10</span> </span>
<span id="cb19-3"><a href="Ch4.html#cb19-3"></a>gMaxL       <span class="op">=</span>  <span class="fl">0.003e03</span> </span>
<span id="cb19-4"><a href="Ch4.html#cb19-4"></a>EL          <span class="op">=</span>  <span class="fl">-54.387</span> </span>
<span id="cb19-5"><a href="Ch4.html#cb19-5"></a>gMaxK       <span class="op">=</span>  <span class="fl">0.36e03</span> </span>
<span id="cb19-6"><a href="Ch4.html#cb19-6"></a>EK          <span class="op">=</span>  <span class="dv">-77</span> </span>
<span id="cb19-7"><a href="Ch4.html#cb19-7"></a>gMaxNa      <span class="op">=</span>  <span class="fl">1.2e03</span> </span>
<span id="cb19-8"><a href="Ch4.html#cb19-8"></a>ENa         <span class="op">=</span>  <span class="dv">50</span> </span>
<span id="cb19-9"><a href="Ch4.html#cb19-9"></a>Ie <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb19-10"><a href="Ch4.html#cb19-10"></a>tFinal <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb19-11"><a href="Ch4.html#cb19-11"></a></span>
<span id="cb19-12"><a href="Ch4.html#cb19-12"></a><span class="co"># Set up data structures</span></span>
<span id="cb19-13"><a href="Ch4.html#cb19-13"></a>timeVec <span class="op">=</span> np.arange(<span class="dv">0</span>,tFinal, dt)</span>
<span id="cb19-14"><a href="Ch4.html#cb19-14"></a>voltageVector <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb19-15"><a href="Ch4.html#cb19-15"></a>Ivector <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb19-16"><a href="Ch4.html#cb19-16"></a>mVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb19-17"><a href="Ch4.html#cb19-17"></a>hVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb19-18"><a href="Ch4.html#cb19-18"></a>nVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb19-19"><a href="Ch4.html#cb19-19"></a>tauVec <span class="op">=</span> np.zeros(<span class="bu">len</span>(timeVec))</span>
<span id="cb19-20"><a href="Ch4.html#cb19-20"></a></span>
<span id="cb19-21"><a href="Ch4.html#cb19-21"></a><span class="co"># Initialize starting values</span></span>
<span id="cb19-22"><a href="Ch4.html#cb19-22"></a>voltageVector[<span class="dv">0</span>] <span class="op">=</span>  <span class="dv">-65</span> </span>
<span id="cb19-23"><a href="Ch4.html#cb19-23"></a>mVec[<span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.0529</span></span>
<span id="cb19-24"><a href="Ch4.html#cb19-24"></a>hVec[<span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.5961</span></span>
<span id="cb19-25"><a href="Ch4.html#cb19-25"></a>nVec[<span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.3177</span></span>
<span id="cb19-26"><a href="Ch4.html#cb19-26"></a>Ivector[<span class="dv">1999</span>:<span class="dv">7999</span>] <span class="op">=</span> Ie</span>
<span id="cb19-27"><a href="Ch4.html#cb19-27"></a></span>
<span id="cb19-28"><a href="Ch4.html#cb19-28"></a><span class="co"># Loop to calculate next values</span></span>
<span id="cb19-29"><a href="Ch4.html#cb19-29"></a><span class="cf">for</span> v <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(timeVec)<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb19-30"><a href="Ch4.html#cb19-30"></a>    alpha_n <span class="op">=</span> <span class="fl">0.01</span><span class="op">*</span>(voltageVector[v] <span class="op">+</span> <span class="dv">55</span>) <span class="op">/</span> </span>
<span id="cb19-31"><a href="Ch4.html#cb19-31"></a>      (<span class="dv">1</span><span class="op">-</span>np.exp(<span class="op">-</span><span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">55</span>)))</span>
<span id="cb19-32"><a href="Ch4.html#cb19-32"></a>    alpha_m <span class="op">=</span> (<span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">40</span>))<span class="op">/</span></span>
<span id="cb19-33"><a href="Ch4.html#cb19-33"></a>      (<span class="dv">1</span><span class="op">-</span>np.exp(<span class="op">-</span><span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">40</span>)))</span>
<span id="cb19-34"><a href="Ch4.html#cb19-34"></a>    alpha_h <span class="op">=</span> <span class="fl">0.07</span><span class="op">*</span>np.exp(<span class="op">-</span>.<span class="dv">05</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">65</span>))</span>
<span id="cb19-35"><a href="Ch4.html#cb19-35"></a>    beta_n <span class="op">=</span> <span class="fl">0.125</span><span class="op">*</span>np.exp(<span class="op">-</span>.<span class="dv">01125</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">55</span>))</span>
<span id="cb19-36"><a href="Ch4.html#cb19-36"></a>    beta_m <span class="op">=</span> <span class="dv">4</span><span class="op">*</span>np.exp(<span class="op">-</span>.<span class="dv">05556</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">65</span>))</span>
<span id="cb19-37"><a href="Ch4.html#cb19-37"></a>    beta_h <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span><span class="fl">0.1</span><span class="op">*</span>(voltageVector[v]<span class="op">+</span><span class="dv">35</span>)))</span>
<span id="cb19-38"><a href="Ch4.html#cb19-38"></a>    </span>
<span id="cb19-39"><a href="Ch4.html#cb19-39"></a>    </span>
<span id="cb19-40"><a href="Ch4.html#cb19-40"></a>    <span class="co">#############</span></span>
<span id="cb19-41"><a href="Ch4.html#cb19-41"></a>    <span class="co"># if timeVec[v] &gt;= 300:</span></span>
<span id="cb19-42"><a href="Ch4.html#cb19-42"></a>         <span class="co">#  =    # Part one</span></span>
<span id="cb19-43"><a href="Ch4.html#cb19-43"></a>    <span class="co"># if timeVec[v] &gt; 600:</span></span>
<span id="cb19-44"><a href="Ch4.html#cb19-44"></a>        <span class="co">#   =    # Part two</span></span>
<span id="cb19-45"><a href="Ch4.html#cb19-45"></a>    <span class="co">##############</span></span>
<span id="cb19-46"><a href="Ch4.html#cb19-46"></a>    </span>
<span id="cb19-47"><a href="Ch4.html#cb19-47"></a>    <span class="co"># Update time constants</span></span>
<span id="cb19-48"><a href="Ch4.html#cb19-48"></a>    tau_n <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (alpha_n <span class="op">+</span> beta_n)</span>
<span id="cb19-49"><a href="Ch4.html#cb19-49"></a>    tau_m <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (alpha_m <span class="op">+</span> beta_m)</span>
<span id="cb19-50"><a href="Ch4.html#cb19-50"></a>    tau_h <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (alpha_h <span class="op">+</span> beta_h)</span>
<span id="cb19-51"><a href="Ch4.html#cb19-51"></a>    </span>
<span id="cb19-52"><a href="Ch4.html#cb19-52"></a>    <span class="co"># Update gating variables</span></span>
<span id="cb19-53"><a href="Ch4.html#cb19-53"></a>    pm <span class="op">=</span> alpha_m<span class="op">/</span>(alpha_m <span class="op">+</span> beta_m)</span>
<span id="cb19-54"><a href="Ch4.html#cb19-54"></a>    pn <span class="op">=</span> alpha_n<span class="op">/</span>(alpha_n<span class="op">+</span> beta_n)</span>
<span id="cb19-55"><a href="Ch4.html#cb19-55"></a>    ph <span class="op">=</span> alpha_h<span class="op">/</span>(alpha_h <span class="op">+</span> beta_h)</span>
<span id="cb19-56"><a href="Ch4.html#cb19-56"></a>    mVec[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> pm <span class="op">+</span> (mVec[v] <span class="op">-</span> pm)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tau_m)</span>
<span id="cb19-57"><a href="Ch4.html#cb19-57"></a>    nVec[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> pn <span class="op">+</span> (nVec[v] <span class="op">-</span> pn)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tau_n)</span>
<span id="cb19-58"><a href="Ch4.html#cb19-58"></a>    hVec[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> ph <span class="op">+</span> (hVec[v] <span class="op">-</span> ph)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tau_h)</span>
<span id="cb19-59"><a href="Ch4.html#cb19-59"></a>    </span>
<span id="cb19-60"><a href="Ch4.html#cb19-60"></a>    <span class="co"># Update voltage</span></span>
<span id="cb19-61"><a href="Ch4.html#cb19-61"></a>    denominator <span class="op">=</span> gMaxL <span class="op">+</span> gMaxK<span class="op">*</span>(nVec[v]<span class="op">**</span><span class="dv">4</span>) <span class="op">+</span> gMaxNa<span class="op">*</span>(mVec[v]<span class="op">**</span><span class="dv">3</span>)<span class="op">*</span>hVec[v]</span>
<span id="cb19-62"><a href="Ch4.html#cb19-62"></a>    tauV <span class="op">=</span> c <span class="op">/</span> denominator</span>
<span id="cb19-63"><a href="Ch4.html#cb19-63"></a>    Vinf <span class="op">=</span> ((gMaxL)<span class="op">*</span>EL <span class="op">+</span> gMaxK<span class="op">*</span>(nVec[v]<span class="op">**</span><span class="dv">4</span>)<span class="op">*</span>EK <span class="op">+</span> </span>
<span id="cb19-64"><a href="Ch4.html#cb19-64"></a>      gMaxNa<span class="op">*</span>(mVec[v]<span class="op">**</span><span class="dv">3</span>)<span class="op">*</span>hVec[v]<span class="op">*</span>ENa <span class="op">+</span> Ivector[v])<span class="op">/</span> denominator   </span>
<span id="cb19-65"><a href="Ch4.html#cb19-65"></a>    voltageVector[v<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> Vinf <span class="op">+</span> </span>
<span id="cb19-66"><a href="Ch4.html#cb19-66"></a>      (voltageVector[v]<span class="op">-</span>Vinf)<span class="op">*</span>np.exp(<span class="op">-</span>dt<span class="op">/</span>tauV) </span>
<span id="cb19-67"><a href="Ch4.html#cb19-67"></a>    </span>
<span id="cb19-68"><a href="Ch4.html#cb19-68"></a><span class="co"># Plot the results</span></span>
<span id="cb19-69"><a href="Ch4.html#cb19-69"></a>plt.figure(<span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">10</span>))</span>
<span id="cb19-70"><a href="Ch4.html#cb19-70"></a>plt.subplot(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb19-71"><a href="Ch4.html#cb19-71"></a>plt.plot(timeVec,voltageVector)</span>
<span id="cb19-72"><a href="Ch4.html#cb19-72"></a>plt.title(<span class="st">&#39;Hodgkin and Huxley Simulation&#39;</span>)</span>
<span id="cb19-73"><a href="Ch4.html#cb19-73"></a>plt.ylabel(<span class="st">&#39;Voltage in mV&#39;</span>)</span>
<span id="cb19-74"><a href="Ch4.html#cb19-74"></a>plt.subplot(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb19-75"><a href="Ch4.html#cb19-75"></a>plt.plot(timeVec, mVec)</span>
<span id="cb19-76"><a href="Ch4.html#cb19-76"></a>plt.ylabel(<span class="st">&#39;g_Na activation variable m&#39;</span>)</span>
<span id="cb19-77"><a href="Ch4.html#cb19-77"></a>plt.subplot(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb19-78"><a href="Ch4.html#cb19-78"></a>plt.plot(timeVec, hVec)</span>
<span id="cb19-79"><a href="Ch4.html#cb19-79"></a>plt.ylabel(<span class="st">&#39;g_Na inactivation variable h&#39;</span>)</span>
<span id="cb19-80"><a href="Ch4.html#cb19-80"></a>plt.subplot(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">4</span>)</span>
<span id="cb19-81"><a href="Ch4.html#cb19-81"></a>plt.plot(timeVec, nVec)</span>
<span id="cb19-82"><a href="Ch4.html#cb19-82"></a>plt.ylabel(<span class="st">&#39;g_K activation variable&#39;</span>)</span></code></pre></div>
<p><em>Part 2</em> Unfortunately, there is no effective treatment to BTX poisoning. However, in theory, the membrane depolarization can be reversed using tetrodotoxin (TTX), which is produced by the pufferfish, blue ringed octopus, and other deadly creatures. This toxin also causes paralysis. However, unlike BTX, TTX prevents action potentials by binding to voltage-gated sodium channels and preventing the movement of sodium ions into the cell. Revise the above code to simulate exposure to TTX 300 ms after the BTX poisoning.</p>
<p><em>Part 3</em> Observe the behavior of the neuron between 600 and 800 ms. While this looks like more ideal behavior than when the neuron was exposed to only BTX, what should the behavior of the neuron be if neither poison had been administered? (Note, while this is a conceptual question, feel free to alter the code to see what should occur).</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Ch3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Ch5.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
